webpackJsonp([19,34],{EUwP:function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={name:"AlarmDetail",filters:{dateTimeFilters:function(a){return commonUtils.timestampToDate(new Date(new Date(a).getTime()+288e5).getTime())}},props:["alarmDetail"],data:function(){return{timeType:"this.alarm.timeType",detailShow:!1,alarm:{}}},methods:{handleClose:function(a){a()},getList:function(a){this.showList=a},toClose:function(){this.alarm={},this.$parent.detailShow=!1},getDetail:function(a){this.alarm=a,this.$parent.detailShow=!0,this.getDe()},getDe:function(){var a=this;this.$RequestUtil.post({url:"/device/alarm/getAlarmInfoByAlarmId",params:{alarmId:this.alarm.alarmId},success:function(e){"success"==e.result?null!=e.data&&(a.alarm=e.data,a.$parent.detailShow=!0):a.$message({type:"error",message:e.msg})}})}}},l={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"AlarmDetail"},[t("el-dialog",{attrs:{"close-on-click-modal":!1,title:"历史详情",visible:a.$parent.detailShow,width:"600px","before-close":a.handleClose},on:{"update:visible":function(e){return a.$set(a.$parent,"detailShow",e)}}},[t("div",{staticClass:"detail"},[1!==a.alarm.alarmRuleType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("设备编号：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(this.alarm.equCode))])]):a._e(),a._v(" "),1!==a.alarm.alarmRuleType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("设备名称：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(this.alarm.equName))])]):a._e(),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("DTU IMEI：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(this.alarm.dtuImei))])]),a._v(" "),1!==a.alarm.alarmRuleType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("设备品类：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(this.alarm.typeName))])]):a._e(),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("告警规则：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(this.alarm.alarmRuleName))])]),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("告警级别：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(1===this.alarm.level?"高":2===a.alarm.level?"中":"低"))])]),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("告警类型：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(1===this.alarm.alarmRuleType?"DTU通信告警":2===a.alarm.alarmRuleType?"阈值告警":3===a.alarm.alarmRuleType?"设备通讯告警":"自定义告警"))])]),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("告警状态：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(0==this.alarm.alarmStatus?"已告警":1==a.alarm.alarmStatus?"处理中":"已解除"))])]),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("推送方式：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(this.alarm.alarmSendTypeName))])]),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("推送内容：")]),a._v(" "),t("div",{staticClass:"value"},[t("el-tooltip",{staticClass:"item",attrs:{transition:"",effect:"dark",content:this.alarm.alarmSendInfo,placement:"right"}},[t("div",[a._v(a._s(this.alarm.alarmSendInfo))]),a._v(" "),t("div",{staticClass:"text"},[a._v(a._s(this.alarm.alarmSendInfo))])])],1)]),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("告警时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a._f("dateTimeFilters")(this.alarm.alarmTime)))])]),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("解除时间：")]),a._v(" "),null!==a.alarm.relieveTime?t("div",{staticClass:"value"},[a._v(a._s(a._f("dateTimeFilters")(this.alarm.relieveTime)))]):a._e()]),a._v(" "),null===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("周期名称：")]),a._v(" "),t("div",{staticClass:"value"},[a._v("全时段")])]):a._e(),a._v(" "),null!==a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("周期名称：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.timeName))])]):a._e(),a._v(" "),t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("周期类型：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(1==a.alarm.timeType?"每日":2==a.alarm.timeType?"每周":3==a.alarm.timeType?"每月":"具体时间"))])]),a._v(" "),1===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("开始时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.startTime))])]):a._e(),a._v(" "),1===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("结束时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.endTime))])]):a._e(),a._v(" "),2===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("开始日期：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(1==a.alarm.startDate?"周一":2==a.alarm.startDate?"周二":3==a.alarm.startDate?"周三":4==a.alarm.startDate?"周四":5==a.alarm.startDate?"周五":6==a.alarm.startDate?"周六":"周日"))])]):a._e(),a._v(" "),2===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("结束日期：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(1==a.alarm.endDate?"周一":2==a.alarm.endDate?"周二":3==a.alarm.endDate?"周三":4==a.alarm.endDate?"周四":5==a.alarm.endDate?"周五":6==a.alarm.endDate?"周六":"周日"))])]):a._e(),a._v(" "),2===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("开始时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.startTime))])]):a._e(),a._v(" "),2===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("结束时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.endTime))])]):a._e(),a._v(" "),3===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("开始日期：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.startDate+"日"))])]):a._e(),a._v(" "),3===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("结束日期：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.endDate+"日"))])]):a._e(),a._v(" "),3===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("开始时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.startTime))])]):a._e(),a._v(" "),3===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("结束时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.endTime))])]):a._e(),a._v(" "),4===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("开始日期：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(this.alarm.startDate))])]):a._e(),a._v(" "),4===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("结束日期：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.endDate))])]):a._e(),a._v(" "),4===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("开始时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.startTime))])]):a._e(),a._v(" "),4===a.alarm.timeType?t("div",{staticClass:"info"},[t("div",{staticClass:"label"},[a._v("结束时间：")]),a._v(" "),t("div",{staticClass:"value"},[a._v(a._s(a.alarm.endTime))])]):a._e()]),a._v(" "),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary"},on:{click:a.toClose}},[a._v("关闭")])],1)])],1)},staticRenderFns:[]};var i=t("C7Lr")(s,l,!1,function(a){t("Py/m")},"data-v-fad6ff8a",null);e.default=i.exports},Kdzu:function(a,e){},"O+ru":function(a,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});t("3cXf");var s=t("ZLEe"),l=t.n(s),i=t("lC5x"),r=t.n(i),n=t("J0Oq"),o=t.n(n),m=(t("+qDl"),{name:"alarm",components:{AlarmDetail:t("EUwP").default},props:{},data:function(){return{loading:!1,dateVal:"",equTypeNameList:[],alarmTypeList:[],searchform:{selEquName:"",selDtuImei:"",selEquCode:"",selEquType:"",selAlarmRuleType:"",selAlarmLeave:"",selAlarmStatus:"",selAlarmRuleId:"",selDate:[],equTypeId:"",selTimePeriod:"",selAlarmRuleName:""},queryParams:{date:[],orderColumn:"gmtCreate",orderType:"DESC"},alarmRuleList:[],tableData:[],selectRow:[],pagination:{currentPage:1,totalPage:0,pagesize:10},fileList:[],protocalList:{},detailShow:!1,styleSear:"style-sear1",btnBoxShow:!1,hidebtn:!1,showbtn:!0,searchclass:"",showTimeRangePanel:!1,searchArr:[]}},beforeMount:function(){},mounted:function(){var a=o()(r.a.mark(function a(){return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return this.searchArr=[{id:"1",label:"设备名称",value:"selEquName",type:"input",maxLen:"50"},{id:"2",label:"DTU IMEI",value:"selDtuImei",type:"input",maxLen:"50"},{id:"3",label:"告警类型",value:"selAlarmRuleType",type:"select",data:[{value:1,label:"DTU通信告警"},{value:2,label:"阈值告警"},{value:3,label:"设备通讯告警"},{value:99,label:"自定义告警"}]},{id:"4",label:"告警规则",value:"selAlarmRuleName",type:"autoInput"},{id:"5",label:"告警级别",value:"selAlarmLeave",type:"select",data:[{label:"高",value:"1"},{label:"中",value:"2"},{label:"低",value:"3"}]},{id:"6",label:"告警状态",value:"selAlarmStatus",type:"select",data:[{label:"已告警",value:"0"},{label:"已解除",value:"2"}]},{id:"7",label:"设备品类",value:"equTypeId",type:"select",data:[]},{id:"8",label:"告警时间",value:"selDate",type:"date"}],this.search(),this.searchEquName(),a.next=5,this.getModelList();case 5:this.searchArr[6].data=this.equTypeNameList;case 6:case"end":return a.stop()}},a,this)}));return function(){return a.apply(this,arguments)}}(),created:function(){},methods:{toggleTimeRangePanel:function(){this.showTimeRangePanel=!this.showTimeRangePanel},handleRangeClose:function(){this.showTimeRangePanel=!1},sortChangeEvent:function(a){this.queryParams.orderColumn=a.order?a.prop:"gmtCreate",this.queryParams.orderType=commonUtils.changeOrderType(a.order),this.pagination.currentPage=1,this.search()},show:function(){this.hidebtn=!0,this.showbtn=!1,this.btnBoxShow=!0,this.searchclass="serheightZ",this.styleSear="style-sear"},hide:function(){this.hidebtn=!1,this.showbtn=!0,this.btnBoxShow=!1,this.searchclass="serheightS",this.styleSear="style-sear1"},pageChange:function(a){this.pagination.currentPage=a.page_index,this.pagination.pagesize=a.page_limit,this.search()},querySearch:function(a,e){var t=this.alarmRuleList;e(a?t.filter(this.createFilter(a)):t)},handleSelect:function(a){this.queryParams.selAlarmRuleId=a},claerRuleName:function(){this.queryParams.selAlarmRuleId=""},createFilter:function(a){return function(e){return e.value.toLowerCase().indexOf(a.toLowerCase())>-1}},changeStatus:function(a){return 0===a.alarmStatus?"已告警":1===a.alarmStatus?"处理中":2===a.alarmStatus?"已解除":void 0},searchPart:function(a){var e=this;this.pagination.currentPage=1,l()(a).forEach(function(t){e.queryParams[t]=a[t]}),null!=this.queryParams.selDate&&null!=this.queryParams.selDate[0]&&null!=this.queryParams.selDate[1]?(this.queryParams.startTime=commonUtils.translateTimeStrToUTC(this.queryParams.selDate[0]),this.queryParams.endTime=commonUtils.translateTimeStrToUTC(this.queryParams.selDate[1])):(this.queryParams.startTime="",this.queryParams.endTime=""),this.search()},clearPart:function(a){var e=this;l()(a).forEach(function(t){e.queryParams[t]=a[t]}),this.queryParams.selDate=[],this.claerRuleName()},getModelList:function(){var a=this;return this.$RequestUtil.post({url:"/device/equipmentType/getEquipmentTypeList",params:{},success:function(e){var t=[];e.data.forEach(function(a){t.push({label:a.typeName,value:a.id})}),a.equTypeNameList=t}})},searchEquName:function(){var a=this;this.$RequestUtil.post({url:"/device/alarmRule/getAlarmRuleList",params:{},success:function(e){if("success"==e.result)for(var t=0;t<e.data.length;t++)a.alarmRuleList.push({name:e.data[t].id,value:e.data[t].name})}})},search:function(){var a=this;this.loading=!0,this.$RequestUtil.post({url:"/device/alarm/getAlarmHistoryListPage",params:{page:this.pagination.currentPage,rows:this.pagination.pagesize,equName:this.queryParams.selEquName,alarmRuleType:this.queryParams.selAlarmRuleType,alarmRuleId:this.queryParams.selAlarmRuleId,dtuImei:this.queryParams.selDtuImei,equCode:this.queryParams.selEquCode,level:this.queryParams.selAlarmLeave,alarmStatus:this.queryParams.selAlarmStatus,startTime:this.queryParams.startTime,endTime:this.queryParams.endTime,relieveTime:this.queryParams.selDate?this.searchform.selDate[3]:"",equTypeId:this.queryParams.equTypeId,timePeriod:this.queryParams.selTimePeriod,orderColumn:this.queryParams.orderColumn,orderType:this.queryParams.orderType},success:function(e){"success"==e.result&&(a.tableData=e.data,a.pagination.totalPage=e.totalPages,a.loading=!1)}})},alarmDetail:function(a){this.$refs.myAlarmDetail.getDetail(a)},getExportTemplate:function(){document.getElementById("ifile").src="device/equipment/exportEquipmentTemplate?token="+localStorage.getItem("token")},handleSelectionChange:function(a){var e=this;this.multipleSelection=[],a.forEach(function(a){e.multipleSelection.push(a.id)})},edit_handleClose:function(a){this.resetEditFields(),a()},handleClose:function(a){this.resetAddFields(),a()},resetAddFields:function(){this.$refs.addForm.clearValidate();var a={stopPropagation:function(){}};this.$refs.cas.clearValue(a),this.addForm.code="",this.addForm.protocol=[]},resetEditFields:function(){this.$refs.editForm.clearValidate();var a={stopPropagation:function(){}};this.$refs.cas.clearValue(a),this.editForm.code="",this.editForm.protocol=[]},transformAlarmTime:function(a){return commonUtils.timestampToDate(new Date(new Date(a.alarmTime).getTime()+288e5).getTime())},transformRelieveTime:function(a){if(null!=a.relieveTime)return commonUtils.timestampToDate(new Date(new Date(a.relieveTime).getTime()+288e5).getTime())}}}),u={render:function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("div",{staticClass:"list-window"},[t("div",{staticClass:"searchbar"},[t("searchInput",{attrs:{searchArr:a.searchArr},on:{clear:function(e){a.clearPart(e)},search:function(e){a.searchPart(e)},querySelect:function(e){var t=e.queryString,s=e.cb;a.querySearch(t,s)},select:function(e){a.handleSelect(e)},autoClear:a.claerRuleName}})],1),a._v(" "),t("div",{staticClass:"list-div"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:a.tableData,"default-sort":{prop:a.queryParams.orderColumn,order:"descending"},"header-row-class-name":"table-header-color"},on:{"sort-change":a.sortChangeEvent,"selection-change":a.handleSelectionChange}},[t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"equCode",label:"设备编号",sortable:"custom"}}),a._v(" "),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"equName",label:"设备名称",sortable:"custom"}}),a._v(" "),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"dtuImei",label:"绑定DTU",sortable:"custom"}}),a._v(" "),t("el-table-column",{attrs:{"show-overflow-tooltip":"",sortable:"custom",label:"告警状态",prop:"alarmStatus"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("span",{style:{color:0===e.row.alarmStatus?"red":null},attrs:{type:"text",size:"mini"}},[a._v("\n            "+a._s(e.row.alarmStatus.toString().replace("0","已告警").replace("1","处理中").replace("2","已解除"))+"\n          ")])]}}])}),a._v(" "),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"alarmRuleName",label:"告警规则",sortable:"custom"}}),a._v(" "),t("el-table-column",{attrs:{formatter:function(a){return a.alarmRuleType?a.alarmRuleType.toString().replace("1","DTU通信告警").replace("2","阈值告警").replace("3","设备通讯告警").replace("99","自定义告警"):null},label:"告警类型",sortable:"custom",prop:"alarmRuleType"}}),a._v(" "),t("el-table-column",{attrs:{formatter:function(a){return a.level?a.level.toString().replace("1","高").replace("2","中").replace("3","低"):null},label:"告警级别",sortable:"custom",prop:"level"}}),a._v(" "),t("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"typeName",label:"设备品类",sortable:"custom"}}),a._v(" "),t("el-table-column",{attrs:{"show-overflow-tooltip":"",formatter:a.transformAlarmTime,label:"告警时间",sortable:"custom",prop:"alarmTime"}}),a._v(" "),t("el-table-column",{attrs:{"show-overflow-tooltip":"",formatter:a.transformRelieveTime,label:"解除时间",sortable:"custom",prop:"relieveTime"}}),a._v(" "),t("el-table-column",{attrs:{label:"操作"},scopedSlots:a._u([{key:"default",fn:function(e){return[t("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){return a.alarmDetail(e.row)}}},[a._v("详情")])]}}])})],1),a._v(" "),[t("Pagination",{attrs:{total:a.pagination.totalPage,"page-num":a.pagination.currentPage},on:{pageChange:a.pageChange}})]],2),a._v(" "),t("AlarmDetail",{ref:"myAlarmDetail"})],1)},staticRenderFns:[]};var v=t("C7Lr")(m,u,!1,function(a){t("Kdzu")},"data-v-71f96d59",null);e.default=v.exports},"Py/m":function(a,e){}});