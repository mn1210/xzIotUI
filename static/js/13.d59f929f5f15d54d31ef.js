webpackJsonp([13],{"/2H/":function(t,e){},"8y5H":function(t,e){},Bdx8:function(t,e){},JOFE:function(t,e){},VXbo:function(t,e){},iF9n:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("3cXf"),i=a.n(n),r=a("lC5x"),s=a.n(r),u=a("J0Oq"),c=a.n(u),o={props:{pieData:Array,title:String,unit:String},data:function(){return{myChart:"",rosePieData:[]}},watch:{rosePieData:{handler:function(t){t&&0!=t.length&&this.drawPie()}},pieData:{handler:function(t){this.rosePieData=t}}},mounted:function(){this.rosePieData=this.pieData},computed:{echarts:function(){return"echarts"+1e5*Math.random()}},methods:{drawPie:function(){var t=this;this.myChart=this.$echarts.getInstanceByDom(document.getElementById(this.echarts)),this.myChart||(this.myChart=this.$echarts.init(document.getElementById(this.echarts)),this.myChart.setOption({title:{left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)",transitionDuration:0},legend:{type:"plain",orient:"vertical",right:window.innerWidth<=1366?0:10,top:20,bottom:20,icon:"circle",textStyle:{color:"#aaa",fontSize:window.innerWidth<=1366?10:12,rich:{a:{width:100}}},formatter:function(t){return"{a|"+t+"}"}},color:["#74C9CA","#F7CF72","#9DD56F","#6F87EC"],series:[]}));var e={series:[{name:this.title,type:"pie",hoverOffset:2,radius:["55%","75%"],center:window.innerWidth<=1366?["40%","50%"]:["35%","50%"],data:this.rosePieData,clockwise:!1,startAngle:180,label:{position:"outer",alignTo:"labelLine",bleedMargin:10,padding:window.innerWidth<=1366?[5,0,0,0]:[20,0,0,0],textStyle:{fontSize:window.innerWidth<=1366?10:13,rich:{a:{align:"left"},b:{}}},formatter:function(e){return["{a|"+e.name+"}","{b|"+e.value+t.unit+" ("+e.percent+"%)}"].join("\n")}},labelLine:{length:3,length2:window.innerWidth<=1366?20:35}}]};this.myChart.setOption(e)}},beforeDestroy:function(){this.myChart&&this.$echarts.dispose(this.myChart)}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticStyle:{width:"100%",height:"100%"}},[e("div",{staticClass:"pie",attrs:{id:this.echarts}})])},staticRenderFns:[]};var l=a("C7Lr")(o,d,!1,function(t){a("JOFE")},"data-v-5b91e47f",null).exports,h={props:{chartData:{type:Array,default:function(){return[]}},chartsInfo:{num:"",name:""},scale:Number},data:function(){return{charts:""}},created:function(){},mounted:function(){var t=this,e=this;e.$nextTick(function(){(t.chartData[0].value||0==t.chartData[0].value)&&e.drawChart()})},watch:{chartData:{handler:function(t){var e=this;this.$nextTick(function(){e.drawChart()})}}},computed:{echarts:function(){return"echarts"+1e5*Math.random()}},methods:{drawChart:function(){var t=window.innerWidth<=1366?"100%":"95%";this.charts=this.$echarts.getInstanceByDom(document.getElementById(this.echarts)),this.charts||(this.charts=this.$echarts.init(document.getElementById(this.echarts)),this.charts.setOption({tooltip:{formatter:"{a} <br/>{b} : {c}%"},series:[]}));var e={series:[{name:"设备分布",type:"gauge",radius:t,detail:{show:!1},data:this.chartData,splitLine:{show:!1},axisLabel:{show:!1},axisTick:{show:!1},pointer:{show:!1},title:{show:!1},axisLine:{lineStyle:{color:[[this.scale,"#F7CF72"],[1,"#ADC6EA"]],width:10}}}]};this.charts.setOption(e)}},beforeDestroy:function(){this.charts&&(this.$echarts.dispose(this.charts),this.charts=null)}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"chartsDiv"},[a("div",{ref:"echarts",staticStyle:{width:"100%",height:"100%"},attrs:{id:t.echarts}}),t._v(" "),a("div",{staticClass:"inChart3"},[a("div",{staticClass:"twoColumn"},[a("div",{staticClass:"bigFont"},[t._v(t._s(t.chartsInfo.num))]),t._v(" "),a("div",{staticClass:"smallFont"},[t._v(t._s(t.chartsInfo.name))])])])])},staticRenderFns:[]};var v={name:"adminHomePage",data:function(){return{loading:!1,topArr:[{name:"总数",value:"sum",id:1},{name:"当月新增",value:"month",id:2}],topData:{sum:{epc:{id:1,name:"epc总数",num:0},dtu:{id:2,name:"dtu总数",num:0},device:{id:3,name:"设备总数",num:0},user:{id:4,name:"账号总数",num:0}},month:{epc:{id:1,name:"epc数",num:0,scale:0},dtu:{id:2,name:"dtu数",num:0,scale:0},device:{id:3,name:"设备数",num:0,scale:0},user:{id:4,name:"账号数",num:0,scale:0}}},contentArr:[{name:"用户数",value:"user",id:1,unit:"个"},{name:"DTU",value:"dtu",id:2,unit:"台"},{name:"设备",value:"device",id:3,unit:"台"},{name:"告警",value:"alarm",id:4,unit:"条"}],contentData:{user:{status:{id:1,data:[]}},dtu:{runType:{id:1,data:[]},status:{id:2,data:[]}},device:{runType:{id:1,data:[]},health:{id:2,data:[]}},alarm:{alarmNum:{id:1,data:[]},isFinished:{id:2,data:[]}}},epcArr:[{label:"epc1",value:2}],epcUser:"",loadingNum:0}},components:{pieCharts:l,gaugeCharts:a("C7Lr")(h,m,!1,function(t){a("VXbo"),a("/2H/")},"data-v-6c39aca1",null).exports},mounted:function(){var t=c()(s.a.mark(function t(){var e=this;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,t.next=3,this.getListUser().then(function(){e.searchCount()});case 3:return t.next=5,this.getAdminOverview().then(function(){e.getAdminOverview(commonUtils.timestampToDate((new Date).getTime()))});case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),watch:{loadingNum:{handler:function(t){6==t&&(this.loading=!1)}}},methods:{searchCount:function(){this.getCountUser(),this.getCountDtu(),this.getCountEquipment(),this.getCountAlarm()},getAdminOverview:function(t){var e=this;return c()(s.a.mark(function a(){return s.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.$RequestUtil.post({url:"/device/overview/getAdminOverview",params:{date:t},success:function(a){if("success"==a.result){var n=void 0;t?((n=JSON.parse(i()(e.topData.month))).user.num=a.data.accountNum,n.dtu.num=a.data.dtuNum,n.device.num=a.data.equipmentNum,n.epc.num=a.data.epcNum,n.epc.scale=n.epc.num/e.topData.sum.epc.num,n.dtu.scale=n.dtu.num/e.topData.sum.dtu.num,n.device.scale=n.device.num/e.topData.sum.device.num,n.user.scale=n.user.num/e.topData.sum.user.num,e.topData.month=n):((n=JSON.parse(i()(e.topData.sum))).user.num=a.data.accountNum,n.dtu.num=a.data.dtuNum,n.device.num=a.data.equipmentNum,n.epc.num=a.data.epcNum,e.topData.sum=n)}e.loadingNum++}});case 2:case"end":return a.stop()}},a,e)}))()},getListUser:function(){var t=this;return c()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$RequestUtil.post({url:"/device/overview/listUser",params:{type:2},success:function(e){var a=[];e.data.forEach(function(t){a.push({label:t.username,value:t.epcId})}),t.epcArr=a,t.epcUser=a[0].value}});case 2:case"end":return e.stop()}},e,t)}))()},selectEpc:function(){this.searchCount()},transPieData:function(t,e,a){var n=[],i=[];return 0!=t.length?t.forEach(function(t){e&&e.includes(t.label)&&n.push({name:t.label,value:t.num}),a&&a.includes(t.label)&&i.push({name:t.label,value:t.num})}):(n=e.map(function(t){return{name:t,value:0}}),a&&(i=a.map(function(t){return{name:t,value:0}}))),n.sort(function(t,e){return e.value-t.value}),i.sort(function(t,e){return e.value-t.value}),{arr1:n,arr2:i}},getCountUser:function(){var t=this;this.$RequestUtil.post({url:"/device/overview/countUser",params:{epc:this.epcUser},success:function(e){t.contentData.user.status.data=t.transPieData(e.data,["禁用","启用"]).arr1,t.loadingNum++}})},getCountDtu:function(){var t=this;this.$RequestUtil.post({url:"/device/overview/countDtu",params:{epc:this.epcUser},success:function(e){var a=t.transPieData(e.data,["未激活","在线","离线"],["启用","禁用"]);t.contentData.dtu.runType.data=a.arr1,t.contentData.dtu.status.data=a.arr2,t.loadingNum++}})},getCountEquipment:function(){var t=this;this.$RequestUtil.post({url:"/device/overview/countEquipment",params:{epc:this.epcUser},success:function(e){var a=t.transPieData(e.data,["在线","离线"],["正常数","故障数"]);t.contentData.device.runType.data=a.arr1,t.contentData.device.health.data=a.arr2,t.loadingNum++}})},getCountAlarm:function(){var t=this;this.$RequestUtil.post({url:"/device/overview/countAlarm",params:{epc:this.epcUser},success:function(e){var a=t.transPieData(e.data,["dtu通讯告警数","阈值告警数","设备通讯告警数","自定义告警数"],["告警中","已解除"]);t.contentData.alarm.alarmNum.data=a.arr1,t.contentData.alarm.isFinished.data=a.arr2,t.loadingNum++}})}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{id:"adminHomePage"}},[a("div",{staticClass:"top"},t._l(t.topArr,function(e){return a("div",{key:e.id,staticClass:"sumData flexBox"},[a("div",{staticClass:"name"},[t._v("\n                "+t._s(e.name)+"\n            ")]),t._v(" "),t._l(t.topData[e.value],function(t){return a("div",{key:t.id,staticClass:"charts flexCenter"},[a("gaugeCharts",{attrs:{chartData:[{value:t.num,name:t.name}],chartsInfo:{num:t.num,name:t.name},scale:t.scale||0===t.scale?t.scale:100}})],1)})],2)}),0),t._v(" "),a("div",{staticClass:"bottom flexBox"},[a("div",{staticClass:"select"},[a("el-select",{attrs:{placeholder:"请选择账户","popper-class":"transSelect"},on:{change:t.selectEpc},model:{value:t.epcUser,callback:function(e){t.epcUser=e},expression:"epcUser"}},t._l(t.epcArr,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("div",{staticClass:"content"},t._l(t.contentArr,function(e){return a("div",{key:e.id,staticClass:"contentSingle flexBox"},[a("div",{staticClass:"name"},[t._v("\n                    "+t._s(e.name)+"\n                ")]),t._v(" "),t._l(t.contentData[e.value],function(n){return a("div",{key:n.id,staticClass:"charts"},[0!=n.data.length?a("pieCharts",{attrs:{pieData:n.data,title:e.name,unit:e.unit}}):t._e()],1)})],2)}),0)])])},staticRenderFns:[]};var f=a("C7Lr")(v,p,!1,function(t){a("8y5H"),a("Bdx8")},"data-v-0d8112a3",null);e.default=f.exports}});