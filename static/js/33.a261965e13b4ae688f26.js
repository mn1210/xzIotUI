webpackJsonp([33],{RDp1:function(e,t){},"XZ/B":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-window"},[a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"DTU分配",visible:e.dtuShow,width:"30%"},on:{"update:visible":function(t){e.dtuShow=t},close:function(t){return e.treeClose()}}},[a("el-row",[e._v("组织列表：")]),e._v(" "),a("el-tree",{ref:"tree",attrs:{data:e.data,props:e.defaultProps,"node-key":"id"},on:{"current-change":e.nodeChange}}),e._v(" "),a("el-row",{staticStyle:{width:"100%","text-align":"center"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.treeSub}},[e._v("确 定")])],1)],1),e._v(" "),a("el-row",{staticClass:"row"},[a("div",{staticClass:"searchbar"},[a("div",{staticClass:"style-sear"},[e._v("序列号：")]),e._v(" "),a("div",{staticClass:"time-input"},[a("el-input",{attrs:{size:"small",maxlength:"15"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.serialnum,callback:function(t){e.serialnum=t},expression:"serialnum"}})],1),e._v(" "),a("div",{staticClass:"style-sear2"},[e._v("分配状态：")]),e._v(" "),a("div",{staticClass:"time-input"},[a("el-select",{attrs:{placeholder:"请选择"},on:{change:e.selectSearch},model:{value:e.fpSelectValue,callback:function(t){e.fpSelectValue=t},expression:"fpSelectValue"}},e._l(e.fpSelect,function(e){return a("el-option",{key:e.id,attrs:{label:e.label,value:e.id}})}),1)],1),e._v(" "),a("div",{staticClass:"ser-but"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.search()}}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"ser-but"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.clear()}}},[e._v("清空")])],1)])]),e._v(" "),a("el-row",[a("div",{staticClass:"operatebar cz-btn"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.dtuDistribution}},[e._v("DTU分配")])],1)]),e._v(" "),a("div",{staticClass:"list-div"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.$store.state.loading,expression:"$store.state.loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"80"}}),e._v(" "),a("el-table-column",{attrs:{label:"仪器",prop:"code"}}),e._v(" "),a("el-table-column",{attrs:{prop:"firmwareVersion",label:"固定版本",align:"right"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sequence",label:"序列号",align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"status",label:"状态",formatter:e.formatterState,align:"left"}}),e._v(" "),a("el-table-column",{attrs:{prop:"upperId",label:"分配组织",formatter:e.formatterupperId,align:"left"}})],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.pageShow,expression:"pageShow"}],staticClass:"pagination-div"},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.pagination.currentPage,total:e.pagination.total},on:{"update:currentPage":function(t){return e.$set(e.pagination,"currentPage",t)},"update:current-page":function(t){return e.$set(e.pagination,"currentPage",t)},"current-change":e.current_change}})],1)],1)],1)},staticRenderFns:[]};var i=a("C7Lr")({name:"devicelist",data:function(){return{data:[],treeData:[],defaultProps:{children:"list",label:"organizationName"},orgId:"",DTU_WORK:!0,fpSelect:[{id:"",label:"全部"},{id:0,label:"未分配"},{id:1,label:"已分配"}],fpSelectValue:"",pageSerialfp:"",dtuShow:!1,serialnum:"",pageSerialnum:"",page:"1",pageShow:!1,multipleSelection:[],pagination:{currentPage:1,total:0},tableData:[],loading:!0}},mounted:function(){this.searchFirst(1,""),this.treeSelect()},methods:{handleSelectionChange:function(e){this.multipleSelection=e},clear:function(){this.pageSerialnum="",this.pageSerialfp="",this.serialnum="",this.fpSelectValue="",this.searchFirst(1,"")},treeClose:function(){this.data=[],this.orgId="",this.dtuShow=!1},treeSelect:function(){var e=this;this.$RequestUtil.post({url:"/test/getOrganizationTree.do",params:{},success:function(t){e.treeData=t.orgList}})},nodeChange:function(e,t){"1"==e.type?this.orgId="":this.orgId=e.id},treeSub:function(){var e=this;if(""!=this.orgId){var t=[];for(var a in this.multipleSelection)t.push(this.multipleSelection[a].id);this.$RequestUtil.post({url:"/test/dtuBindOrganization",params:{upperId:this.orgId,dtuId:t},success:function(t){"success"==t.result?(e.treeClose(),e.$message({type:"success",message:t.message}),e.searchFirst(e.page,e.pageSerialnum)):e.$message({type:"error",message:t.message})}})}else this.$message({message:"请选择班组",type:"warning"})},dtuDistribution:function(){"0"==this.multipleSelection.length?this.$message({message:"请选择DTU",type:"warning"}):(this.data=this.treeData,this.dtuShow=!0)},formatterState:function(e){return null!=e.status?e.status.toString().replace(0,"未激活").replace(1,"激活"):""},formatterupperId:function(e){return null==e.upperId?"未分配":"已分配"},selectSearch:function(){"0"==this.fpSelectValue?this.DTU_WORK=!1:this.DTU_WORK=!0,this.searchFirst("1",this.serialnum)},searchFirst:function(e,t){var a=this;this.pageSerialnum=this.serialnum,this.pageSerialfp=this.fpSelectValue,this.$RequestUtil.post({url:"/test/getDtuListByUserNameAndOther",params:{page:e,rows:10,sequence:t,upperId:this.pageSerialfp},success:function(e){a.tableData=e.list,a.pagination.total=e.total,a.pagination.total>10?a.pageShow=!0:a.pageShow=!1}})},resetForm:function(e){this.$refs[e].resetFields(),this.workForm.workParms=""},current_change:function(e){var t=this;this.page=e,this.$RequestUtil.post({url:"/test/getDtuListByUserNameAndOther",params:{page:this.page,rows:10,sequence:this.pageSerialnum,upperId:this.pageSerialfp},success:function(e){t.tableData=e.list}})}}},s,!1,function(e){a("RDp1"),a("xqrF")},"data-v-012ebade",null);t.default=i.exports},xqrF:function(e,t){}});