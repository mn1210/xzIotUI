webpackJsonp([12],{BNR5:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("ZLEe"),r=s.n(a),i=s("3cXf"),l=s.n(i),n=s("lC5x"),o=s.n(n),u=s("J0Oq"),c=s.n(u),d={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"UserDetail",attrs:{id:"userDet"}},[s("el-dialog",{attrs:{"close-on-click-modal":!1,title:"用户详情",visible:e.$parent.detailModel,width:"391px","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.$parent,"detailModel",t)}}},[s("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"用户信息",name:"first"}},[s("el-row",[s("el-col",{attrs:{span:12}})],1),e._v(" "),s("span",{staticClass:"spanClass el-inputcss"},[e._v("账号：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.userDetail.username))]),e._v(" "),s("br"),e._v(" "),s("span",{staticClass:"spanClass el-inputcss"},[e._v("昵称：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.userDetail.nickName))]),e._v(" "),s("br"),e._v(" "),s("span",{staticClass:"spanClass el-inputcss"},[e._v("手机号：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.userDetail.userTel))]),e._v(" "),s("br"),e._v(" "),s("span",{staticClass:"spanClass el-inputcss"},[e._v("邮箱：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.userDetail.email))]),e._v(" "),s("br"),e._v(" "),s("span",{staticClass:"spanClass el-inputcss"},[e._v("角色名：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.userDetail.roleName))]),e._v(" "),s("br"),e._v(" "),s("span",{staticClass:"spanClass el-inputcss"},[e._v("类型：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.userDetail.userType))]),e._v(" "),s("br"),e._v(" "),s("span",{staticClass:"spanClass el-inputcss"},[e._v("状态：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.userDetail.isEnable))]),e._v(" "),s("br"),e._v(" "),3===e.userDetail.userType?s("div",[s("span",{staticClass:"spanClass el-inputcss"},[e._v("组织名：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.userDetail.orgName))])]):e._e(),e._v(" "),2===e.userDetail.userType?s("div",[s("span",{staticClass:"spanClass el-inputcss"},[e._v("云服务：")]),e._v(" "),s("span",{staticClass:"user-det-class"},[e._v(e._s(e.cloudType))])]):e._e()],1),e._v(" "),s("el-tab-pane",{attrs:{label:"权限信息",name:"second"}},[s("el-table",{staticClass:"table-class",staticStyle:{width:"100%"},attrs:{data:e.userDetail.permissionsList,height:"250"}},[s("el-table-column",{attrs:{prop:"permissionInfo",label:"权限详情","min-width":"200"}})],1)],1),e._v(" "),s("el-tab-pane",{attrs:{label:"区域列表",name:"third"}},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userDetail.userAreaList,height:"250"}},[s("el-table-column",{attrs:{prop:"areaName",label:"区域名"}})],1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(){e.$parent.detailModel=!1,e.activeName="first"}}},[e._v("关 闭")])],1)],1)],1)},staticRenderFns:[]};var p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"AssUser"},[s("el-dialog",{attrs:{"close-on-click-modal":!1,title:"分配用户",visible:e.$parent.AssModel,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.$parent,"AssModel",t)}}},[e._v("\n    组织列表：\n    "),s("br"),e._v(" "),s("el-tree",{ref:"tree",attrs:{data:e.showList,"node-key":"id",props:e.defaultProps,accordion:""},on:{"node-click":e.handleNodeClick}}),e._v(" "),s("br"),e._v(" "),s("br"),e._v("当前所选组织：\n    "),s("span",[e._v(e._s(e.orgName))]),e._v(" "),s("br"),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.toAss}},[e._v("确认")])],1)],1)],1)},staticRenderFns:[]};var m={name:"userList",components:{UserDetail:s("C7Lr")({name:"UserDetail",props:["userDetail"],data:function(){return{detailModel:!1,activeName:"first"}},computed:{cloudType:function(){switch(this.userDetail.cloudType){case 1:return"微软";case 2:return"阿里云";case 3:return"本地云"}return""}},methods:{handleClose:function(e){e(),this.detailModel=!1,this.activeName="first"},handleClick:function(e,t){}}},d,!1,function(e){s("CdUU"),s("E+Pp")},"data-v-e35bf7e8",null).exports,AssUser:s("C7Lr")({name:"AssUser",props:["assUser"],data:function(){return{AssModel:!1,showList:[],defaultProps:{children:"list",label:"organizationName"},chonseTab:{},orgName:"",userList:[]}},methods:{handleNodeClick:function(e){this.chonseTab=e,this.orgName=e.organizationName},handleClose:function(e){e(),this.assUser.AssModel=!1,this.chonseTab={}},getList:function(e){this.showList=e},toAss:function(){var e=this;null!=this.chonseTab&&null!=this.chonseTab.id?this.$confirm("是否确认分配该组织下？").then(function(t){e.sureAss()}).catch(function(e){}):this.$message({message:"请选择需要分配的组织",type:"warning"})},sureAss:function(){var e=this;this.$RequestUtil.post({url:"/user/user/assUserList",params:{userList:this.userList,upperIdForAss:this.chonseTab.id,upperTypeForAss:this.chonseTab.type},success:function(t){"success"==t.result?(e.$message({message:t.msg,type:"success"}),e.$parent.AssModel=!1,e.orgName="",e.$parent.search()):e.$message({message:t.msg,type:"error"})}})},getUser:function(e){this.userList=e}}},p,!1,function(e){s("TVGn")},"data-v-36278976",null).exports,numberInput:s("Mj+y").a},data:function(){return{loading:!1,userType:Number(localStorage.getItem("wuyuanUserType")),upperId:Number(localStorage.getItem("upperId")),selUserList:[],searchform:{searchUser:"",searchOrg:""},queryParams:{searchUser:"",searchOrg:"",orderColumn:"",orderType:"DESC"},selectRow:{},assList:{list:[]},casProps:{children:"list",label:"organizationName",value:"organizationCode"},chonseRows:[],companyName:"",addModel:!1,editModel:!1,detailModel:!1,AssModel:!1,addBelong:[],editBelong:[],allOrgList:[],addCart:{userName:"",password:"",nickName:"",telPhone:"",email:"",roleId:"",areaId:[],upperId:"",cloudType:1,epcName:"",equLimitNum:""},editCart:{id:"",userName:"",password:"",nickName:"",telPhone:"",email:"",roleId:"",upperId:"",areaId:[],cloudType:1,epcName:"",equLimitNum:""},roles:[],areas:[],pagination:{currentPage:1,totalPage:0,pagesize:10},rules:{userName:[{required:!0,message:"请输入帐号,帐号为字母或数字组合,以字母开头",trigger:"blur"},{validator:function(e,t,s){!1===/^[A-Za-z]+/.test(t)&&s(new Error("字母开头")),0==/^[A-Za-z0-9]{1,30}$/.test(t)?s(new Error("请输入帐号,帐号为字母或数字组合,以字母开头")):s()},trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:function(e,t,s){0==/^[A-Za-z][A-Za-z0-9]{7}$/.test(t)?s(new Error("密码为字母和数字组合，首位为字母，长度为8")):s()},trigger:"blur"}],nickName:[{required:!0,message:"请输入昵称",trigger:"blur"},{validator:function(e,t,s){commonUtils.regExp.noSpecialChar(t)?s():s(new Error("不能有特殊字符"))},trigger:"blur"}],telPhone:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:function(e,t,s){0==/^1[34578]\d{9}$/.test(t)?s(new Error("请输入正确的手机号")):s()},trigger:"blur"}],equLimitNum:[],epcName:[],email:[{validator:function(e,t,s){""!=t&&0==/^(\w|\-|\.)+@(\w|\-)+\.([a-zA-Z]{2,4})$/.test(t)?s(new Error("请输入正确的邮箱")):s()},trigger:"blur"}],roleId:[{required:!0,message:"请选择角色",trigger:"change"}],upperId:[{required:!0,message:"请选择组织",trigger:"change"}],areaId:[{required:!0,message:"请选择区域",trigger:"change"}]},headPic:{headPic:"1"},fileList:[],headPicObj:{},userOrgCode:localStorage.getItem("wuyuanUserOrgCode"),nowLoginName:"",searchArr:[],uploadText:"点击上传"}},computed:{labelWidth:function(){return window.innerWidth<=1366?"47px":"45px"}},watch:{editBelong:function(e){var t=e;t.length>0&&(this.editCart.upperId=t[t.length-1])}},created:function(){var e=c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.allRoleList(),this.getAreaList(),this.search();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),mounted:function(){var e=c()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchArr=[{id:"1",label:"账号",value:"searchUser",type:"input",maxLen:"15"},{id:"2",label:"组织",value:"searchOrg",type:"cascader",data:[],casProps:{children:"list",label:"organizationName",value:"organizationCode"}}],e.next=3,this.getTree();case 3:this.searchArr[1].data=this.assList,this.nowLoginName=localStorage.getItem("loginName");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{isEpc:function(e){2==e?(this.rules.epcName.push({required:!0,message:"请填写epc名称",trigger:"blur"}),this.rules.epcName.push({validator:function(e,t,s){commonUtils.regExp.noSpecialChar(t)?s():s(new Error("不能有特殊字符"))},trigger:"blur"}),this.rules.equLimitNum.push({required:!0,message:"请填写设备限制数",trigger:"blur"})):(this.rules.epcName=[],this.rules.equLimitNum=[])},sortChangeEvent:function(e){this.queryParams.orderColumn=e.order?e.prop:"gmtModified",this.queryParams.orderType=commonUtils.changeOrderType(e.order),this.pagination.currentPage=1,this.search()},resetPassword:function(e){var t=this;this.$prompt("请输入密码","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"password",inputPattern:/^[A-Za-z][A-Za-z0-9]{7}$/,inputErrorMessage:"密码为8位字母和数字组合，首位为字母"}).then(function(s){var a=s.value;t.$RequestUtil.post({url:"/user/user/updateUserInfo",params:{id:e.id,password:a},success:function(e){"success"==e.result&&t.$message({message:e.msg,type:"success"})}})}).catch(function(){})},changEnable:function(e,t){var s=this;this.$confirm("是否"+t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.$RequestUtil.postSync({url:"/user/user/updateUserInfo",params:{id:e.id,isEnable:Number(!e.isEnable)},success:function(e){"success"==e.result&&(s.$message({message:e.msg,type:"success"}),s.search())}})})},chonseAddOrg:function(e){var t=e;t.length>0&&(this.addCart.upperId=t[t.length-1])},chonseEditOrg:function(e){var t=e;t.length>0&&(this.editCart.upperId=t[t.length-1])},getUpperInfo:function(e){var t=0;for(var s in this.allOrgList)if(e==this.allOrgList[s].organizationCode){t=this.allOrgList[s].parentId;break}this.editBelong.unshift(e),this.getParentId(this.editBelong,t)},getParentId:function(e,t){for(var s in this.allOrgList)if(t==this.allOrgList[s].id){e.unshift(this.allOrgList[s].organizationCode),this.getParentId(e,this.allOrgList[s].parentId);break}},toSearch:function(e){this.pagination.currentPage=1,this.queryParams.searchUser=e.searchUser,this.queryParams.searchOrg=e.searchOrg,this.search()},search:function(){var e=this;this.loading=!0;var t="";return 0!=this.queryParams.searchOrg.length&&(t=this.queryParams.searchOrg.slice(-1)[0]),this.$RequestUtil.post({url:"user/user/getUserListPage",params:{username:this.queryParams.searchUser,userOrgCode:t,page:this.pagination.currentPage,rows:this.pagination.pagesize,orderColumn:this.queryParams.orderColumn,orderType:this.queryParams.orderType},success:function(t){"success"==t.result?(e.selUserList=t.data,e.pagination.totalPage=t.totalPages,e.loading=!1):e.$message({message:t.msg,type:"error"})}}).catch(function(){e.loading=!1})},clearPart:function(){this.queryParams.searchUser="",this.queryParams.searchOrg=""},allRoleList:function(){var e=this;this.$RequestUtil.post({url:"/user/role/getRoleList",params:{},success:function(t){"success"==t.result&&(e.roles=t.data,1===e.userType?e.roles=e.roles.filter(function(e){return 2===e.type}):2===e.userType&&(e.roles=e.roles.filter(function(e){return 1!==e.type})))}})},getAreaList:function(){var e=this;return this.$RequestUtil.post({url:"/device/area/getAreaList",params:{},success:function(t){"success"==t.result&&(e.areas=t.data)}})},resetForm:function(e){this.$refs[e].resetFields()},pageChange:function(e){this.pagination.currentPage=e.page_index,this.pagination.pagesize=e.page_limit,this.search()},edit:function(e){0!=e.userStatus?1!=this.userType||3!=e.userType?2==this.userType||this.userOrgCode!=e.orgCode||this.nowLoginName==e.username?(this.editCart.userType=e.userType,this.editCart.userName=e.username,this.editCart.nickName=e.nickName,this.editCart.telPhone=e.userTel,this.editCart.email=e.email,this.editCart.roleId=e.rId,this.editCart.id=e.id,this.editCart.upperId=e.upperId,this.editCart.cloudType=e.cloudType,this.isEpc(e.rId),2==e.rId&&(this.editCart.equLimitNum=e.equLimitNum,this.editCart.epcName=e.epcName),this.editCart.areaId=e.userAreaList.map(function(e){return e.areaId}),this.fileList=[],e.userPic?(this.uploadText="替换图片",this.fileList=[{name:"",url:e.userPic}]):this.uploadText="点击上传",this.getUpperInfo(e.orgCode),this.editModel=!0):this.$message({message:"不能编辑与自己同层级组织的账户",type:"warning"}):this.$message({message:"当前用户只能编辑EPC管理员",type:"warning"}):this.$message({message:"系统账号不允许编辑",type:"warning"})},toUpdate:function(){var e=this;this.$refs.editCartForm.validate(function(t,s){if(!t)return!1;e.$confirm("是否确认编辑用户信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.sureUpdate()}).catch(function(){})})},sureUpdate:function(){var e,t=this;this.$RequestUtil.postSync({url:"/user/user/updateUser",params:{id:this.editCart.id,nickName:this.editCart.nickName,username:this.editCart.userName,userTel:this.editCart.telPhone,roleId:this.editCart.roleId,email:this.editCart.email,userOrgCode:this.editCart.upperId,cloudType:this.editCart.cloudType,userAreaList:this.editCart.areaId.map(function(e){return{areaId:e}}),userPic:this.headPicObj.url,epcName:this.editCart.epcName,equLimitNum:this.editCart.equLimitNum},success:(e=c()(o.a.mark(function e(s){var a;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("success"!=s.result){e.next=11;break}return t.$message({message:s.msg,type:"success"}),t.fileList=[],t.editModel=!1,t.resetForm("editCartForm"),e.next=7,t.search();case 7:t.userId===t.editCart.id&&(t.$store.commit("updateNickname",t.editCart.nickName),a=t.selUserList.filter(function(e){return e.id===t.userId}),t.$store.commit("updateUserPic",a[0].userPic)),t.editBelong=[],e.next=12;break;case 11:t.$message({message:s.msg,type:"error"});case 12:case"end":return e.stop()}},e,t)})),function(t){return e.apply(this,arguments)})})},toSave:function(){var e=this;this.$refs.addCartForm.validate(function(t){if(!t)return!1;e.$confirm("是否确认保存用户信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.sureSave()}).catch(function(){})})},sureSave:function(){var e=this,t=this;this.$RequestUtil.post({url:"/user/user/addUser",params:{username:this.addCart.userName,password:this.addCart.password,nickName:this.addCart.nickName,userTel:this.addCart.telPhone,roleId:this.addCart.roleId,email:this.addCart.email,userOrgCode:this.addCart.upperId,userAreaList:this.addCart.areaId.map(function(e){return{areaId:e}}),roleType:this.roles.filter(function(t){return t.id===e.addCart.roleId})[0].type,cloudType:this.addCart.cloudType,userPic:this.headPicObj.url,epcName:this.addCart.epcName,equLimitNum:this.addCart.equLimitNum},success:function(s){"success"==s.result?(e.$message({message:s.msg,type:"success"}),e.fileList=[],e.addModel=!1,e.resetForm("addCartForm"),e.search(),t.addBelong=[]):e.$message({message:s.msg,type:"error"})}})},forUpperName:function(e){return null==e.orgName||""==e.orgName?"无":e.orgName},formatterState:function(e){return 1==e.userType?"超级管理员":2===e.userType?"EPC管理员":"普通用户"},formatterIsDel:function(e){return e.isEnable?"禁用":"启用"},handleSelectionChange:function(e){this.chonseRows=e},handleClose:function(e){this.resetForm("editCartForm"),this.fileList=[],this.editBelong.length=0,e()},addClose:function(e){this.resetForm("addCartForm"),this.addBelong.length=0,this.fileList=[],e()},setUser:function(){for(var e=0;e<this.chonseRows.length;e++)if(0==this.chonseRows[e].userStatus)return void this.$message({message:"系统账号不允许分配组织",type:"warning"});if(0!=this.chonseRows.length){for(var t=[],s=0;s<this.chonseRows.length;s++)t.push(this.chonseRows[s].id);this.$refs.AssCartModel.getUser(t),this.AssModel=!0}else this.$message({message:"请勾选需要分配组织的用户",type:"warning"})},delUser:function(){for(var e=this,t=0;t<this.chonseRows.length;t++){if(0==this.chonseRows[t].userStatus)return void this.$message({message:"系统账号不允许删除",type:"warning"});if(1==this.userType&&3==this.chonseRows[t].userType)return void this.$message({message:"当前用户只能删除EPC管理员",type:"warning"});if(this.chonseRows[t].username==this.nowLoginName)return void this.$message({message:"不能删除自己，请重新选择",type:"warning"});if(2!=this.userType&&this.chonseRows[t].orgCode==this.userOrgCode)return void this.$message({message:"不能删除与自己同层级组织的账号，请重新选择",type:"warning"})}0!=this.chonseRows.length?this.$confirm("确认删除此用户？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(t){e.sureDel()}).catch(function(e){}):this.$message({message:"请勾选需要删除的用户",type:"warning"})},sureDel:function(){for(var e=this,t=[],s=0;s<this.chonseRows.length;s++)t.push(this.chonseRows[s].id);t.length<=0?this.$message({message:"请勾选需要删除的用户",type:"warning"}):this.$RequestUtil.post({url:"/user/user/deleteUser",params:{delLists:t},success:function(t){"success"==t.result?(e.$message({message:t.msg,type:"success"}),e.pagination.currentPage=1,e.search()):e.$message({message:t.msg,type:"error"})}})},getDetail:function(e){var t=this;this.$RequestUtil.post({url:"/user/user/getUserInfoById",params:{id:e.id},success:function(s){t.selectRow=JSON.parse(l()(e)),t.selectRow.permissionsList=s.data.permissionList,t.selectRow.userType=t.formatterState(e),t.selectRow.isEnable=t.formatterIsDel(e),t.detailModel=!0}})},getTree:function(){var e=this;return this.$RequestUtil.post({url:"/user/org/getOrganizationList",params:{},success:function(t){"fail"!=t.result?null!=t.data.organizationId&&null!=t.data.list&&(e.allOrgList=t.data.list,e.init(e.assList.list,t.data.list,t.data.organizationId),e.assList.list.forEach(function(s){null==s.parentId?e.loadOrg(s,s.id,t.data.list):e.loadOrg(s,t.data.organizationId,t.data.list)}),e.assList.list.length>0&&0==e.assList.list[0].list.length&&(e.assList.list[0].list=null),e.$refs.AssCartModel.getList(e.assList.list)):e.$alert(t.msg,"提示",{confirmButtonText:"确定",type:"warning"})}})},init:function(e,t,s){t.forEach(function(t){t.id!=s&&null!=t.parentId||(t.list=[],e.push(t))})},loadOrg:function(e,t,s){var a=this;s.forEach(function(i,l){if(i.parentId==t){r()(e).includes("list")||(e.list=[]);var n=e.list;n.push(i),a.loadOrg(n[n.length-1],i.id,s)}})},upLoadSuccess:function(e,t,s){null!=e.message&&""!=e.message?(this.uploadText="点击上传",this.$message.error(e.message),this.$refs.upload.clearFiles()):(this.headPicObj={name:e.data.name,url:e.data.url},t.name="",this.uploadText="替换图片")},uploadRemove:function(e,t){this.headPicObj={name:"",url:""}},changeImg:function(e,t){t.length>1&&t.splice(0,1)},beforeUpload:function(e){return e.name.endsWith(".jpg")||e.name.endsWith(".png")?e.size>1e7?(this.$message.error("图片不能大于10M"),!1):void 0:(this.$message.error("只能上传jpg/png格式图片"),!1)}}},h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"list-window",attrs:{id:"userList"}},[s("div",{staticClass:"searchbar"},[s("searchInput",{attrs:{"search-arr":e.searchArr},on:{clear:function(t){e.clearPart()},search:function(t){e.toSearch(t)}}})],1),e._v(" "),e.$PERMISSION.USER_WRITE?s("div",{staticClass:"operatebar"},[1===e.userType||2===e.userType?s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){e.addModel=!0,e.uploadText="点击上传"}}},[e._v("新增")]):e._e(),e._v(" "),s("el-button",{attrs:{plain:"",size:"small"},on:{click:e.delUser}},[e._v("删除")])],1):e._e(),e._v(" "),s("div",{staticClass:"list-div"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.selUserList,"tooltip-effect":"dark","default-sort":{prop:e.queryParams.orderColumn,order:"descending"}},on:{"sort-change":e.sortChangeEvent,"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"60",sortable:"custom"}}),e._v(" "),s("el-table-column",{attrs:{prop:"username",label:"帐号","min-width":"100",sortable:"custom"}}),e._v(" "),s("el-table-column",{attrs:{prop:"nickName",label:"昵称","min-width":"80",sortable:"custom"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userTel",label:"电话","min-width":"100",sortable:"custom"}}),e._v(" "),s("el-table-column",{attrs:{prop:"orgName",label:"所属组织",formatter:e.forUpperName,"min-width":"100",sortable:"custom"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userStatus",label:"类型","min-width":"80",formatter:e.formatterState,sortable:"custom"}}),e._v(" "),s("el-table-column",{attrs:{prop:"deleted",label:"状态","min-width":"80",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("div",{class:0==t.row.isEnable?"colorGreen":"colorRed"},[e._v(e._s(0==t.row.isEnable?"启用":"禁用"))])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"text"},on:{click:function(){return e.getDetail(t.row)}}},[e._v("详情")]),e._v(" "),e.$PERMISSION.USER_WRITE?s("span",{staticClass:"vertical"}):e._e(),e._v(" "),e.$PERMISSION.USER_WRITE?s("el-button",{attrs:{disabled:3===e.userType&&t.row.upperId===e.upperId,type:"text"},on:{click:function(){return e.edit(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.$PERMISSION.USER_WRITE?s("span",{staticClass:"vertical"}):e._e(),e._v(" "),e.$PERMISSION.USER_WRITE&&t.row.isEnable?s("el-button",{attrs:{type:"text",disabled:2==e.userType&&t.row.username==e.nowLoginName},on:{click:function(s){return e.changEnable(t.row,"启用")}}},[e._v("启用")]):e._e(),e._v(" "),e.$PERMISSION.USER_WRITE&&!t.row.isEnable?s("el-button",{attrs:{type:"text",disabled:2==e.userType&&t.row.username==e.nowLoginName},on:{click:function(s){return e.changEnable(t.row,"禁用")}}},[e._v("禁用")]):e._e(),e._v(" "),e.$PERMISSION.USER_WRITE?s("span",{staticClass:"vertical"}):e._e(),e._v(" "),e.$PERMISSION.USER_WRITE?s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.resetPassword(t.row)}}},[e._v("重置密码")]):e._e()]}}])})],1),e._v(" "),s("Pagination",{attrs:{total:e.pagination.totalPage,"page-num":e.pagination.currentPage},on:{pageChange:e.pageChange}})],1),e._v(" "),s("el-dialog",{attrs:{"close-on-click-modal":!1,title:"新增用户",visible:e.addModel,width:"30%","before-close":e.addClose},on:{"update:visible":function(t){e.addModel=t}}},[s("el-row",{attrs:{type:"flex"}},[s("el-col",{attrs:{span:21}},[s("el-form",{ref:"addCartForm",attrs:{model:e.addCart,rules:e.rules,"label-width":"100px","label-position":"right"}},[s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"帐号：",prop:"userName"}},[s("el-input",{attrs:{maxlength:"25",placeholder:"请输入账号"},model:{value:e.addCart.userName,callback:function(t){e.$set(e.addCart,"userName",t)},expression:"addCart.userName"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"密码：",prop:"password"}},[s("el-input",{attrs:{placeholder:"请输入密码",maxlength:"8",type:"password",autocomplete:"new-password"},model:{value:e.addCart.password,callback:function(t){e.$set(e.addCart,"password",t)},expression:"addCart.password"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"昵称：",prop:"nickName"}},[s("el-input",{attrs:{maxlength:"25",placeholder:"请输入昵称"},model:{value:e.addCart.nickName,callback:function(t){e.$set(e.addCart,"nickName",t)},expression:"addCart.nickName"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"手机号：",prop:"telPhone"}},[s("el-input",{attrs:{maxlength:"11",placeholder:"请输入手机号"},model:{value:e.addCart.telPhone,callback:function(t){e.$set(e.addCart,"telPhone",t)},expression:"addCart.telPhone"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"角色：",prop:"roleId"}},[s("el-select",{attrs:{placeholder:"请选择角色"},on:{change:e.isEpc},model:{value:e.addCart.roleId,callback:function(t){e.$set(e.addCart,"roleId",t)},expression:"addCart.roleId"}},e._l(e.roles.filter(function(t){return 2!=e.userType||3===t.type}),function(e){return s("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}),1)],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.addCart.roleId,expression:"addCart.roleId==2"}],staticClass:"el-inputcss",attrs:{label:"epc名称：",prop:"epcName"}},[s("el-input",{attrs:{maxlength:"25",placeholder:"请输入epc名称"},model:{value:e.addCart.epcName,callback:function(t){e.$set(e.addCart,"epcName",t)},expression:"addCart.epcName"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.addCart.roleId,expression:"addCart.roleId==2"}],staticClass:"el-inputcss",attrs:{label:"设备限制数：",prop:"equLimitNum"}},[s("numberInput",{attrs:{"max-num":"9",placeholder:"请输入设备限制数"},model:{value:e.addCart.equLimitNum,callback:function(t){e.$set(e.addCart,"equLimitNum",t)},expression:"addCart.equLimitNum"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"邮箱：",prop:"email"}},[s("el-input",{attrs:{maxlength:"50",placeholder:"请输入邮箱"},model:{value:e.addCart.email,callback:function(t){e.$set(e.addCart,"email",t)},expression:"addCart.email"}})],1),e._v(" "),e.addModel&&1!==e.userType?s("el-form-item",{staticClass:"el-inputcss",attrs:{prop:"upperId",label:"组织："}},[s("el-cascader",{attrs:{placeholder:"请选择组织",options:e.assList.list,props:e.casProps,"show-all-levels":!1,"change-on-select":""},on:{change:e.chonseAddOrg},model:{value:e.addBelong,callback:function(t){e.addBelong=t},expression:"addBelong"}})],1):e._e(),e._v(" "),2===e.userType?s("el-form-item",{staticClass:"el-inputcss",attrs:{prop:"areaId",label:"区域："}},[s("el-select",{attrs:{placeholder:"请选择区域",multiple:""},model:{value:e.addCart.areaId,callback:function(t){e.$set(e.addCart,"areaId",t)},expression:"addCart.areaId"}},e._l(e.areas,function(e){return s("el-option",{key:e.id,attrs:{label:e.areaName,value:e.id}})}),1)],1):e._e(),e._v(" "),1===e.userType?s("el-form-item",{staticClass:"el-inputcss",attrs:{required:"",prop:"cloudType",label:"云服务："}},[s("el-select",{attrs:{placeholder:"请选择云服务"},model:{value:e.addCart.cloudType,callback:function(t){e.$set(e.addCart,"cloudType",t)},expression:"addCart.cloudType"}},[s("el-option",{attrs:{label:"微软",value:1}}),e._v(" "),s("el-option",{attrs:{label:"阿里云",value:2}}),e._v(" "),s("el-option",{attrs:{label:"本地云",value:3}})],1)],1):e._e(),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"用户头像："}},[s("el-upload",{ref:"upload",staticStyle:{display:"inline"},attrs:{action:"/wuyuan/upload/uploadPicture",accept:".png, .jpg, .bmp, .gif",method:"post",data:e.headPic,"on-change":e.changeImg,"on-success":e.upLoadSuccess,"on-remove":e.uploadRemove,"before-upload":e.beforeUpload,"file-list":e.fileList,"list-type":"picture-card"}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v(e._s(e.uploadText))])],1)],1)],1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.toSave}},[e._v("确 定")])],1)],1),e._v(" "),s("el-dialog",{attrs:{"close-on-click-modal":!1,title:"用户编辑",visible:e.editModel,width:"30%","before-close":e.handleClose},on:{"update:visible":function(t){e.editModel=t}}},[s("el-row",{attrs:{type:"flex"}},[s("el-col",{attrs:{span:21}},[s("el-form",{ref:"editCartForm",attrs:{model:e.editCart,rules:e.rules,"label-width":"100px","label-position":"right"}},[s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"帐号：",prop:"userName"}},[s("el-input",{attrs:{maxlength:"25",placeholder:"请输入账号",disabled:!0},model:{value:e.editCart.userName,callback:function(t){e.$set(e.editCart,"userName",t)},expression:"editCart.userName"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"昵称：",prop:"nickName"}},[s("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.editCart.nickName,callback:function(t){e.$set(e.editCart,"nickName",t)},expression:"editCart.nickName"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"手机号：",prop:"telPhone"}},[s("el-input",{attrs:{maxlength:"11",placeholder:"请输入手机号"},model:{value:e.editCart.telPhone,callback:function(t){e.$set(e.editCart,"telPhone",t)},expression:"editCart.telPhone"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"角色：",prop:"roleId"}},[s("el-select",{attrs:{disabled:e.userId===e.editCart.id,placeholder:"请选择角色"},model:{value:e.editCart.roleId,callback:function(t){e.$set(e.editCart,"roleId",t)},expression:"editCart.roleId"}},e._l(e.roles.filter(function(t){return 3!==e.editCart.userType||3===t.type}),function(e){return s("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}),1)],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.editCart.roleId,expression:"editCart.roleId==2"}],staticClass:"el-inputcss",attrs:{label:"epc名称：",prop:"epcName"}},[s("el-input",{attrs:{maxlength:"25",placeholder:"请输入epc名称",disabled:2==e.userType},model:{value:e.editCart.epcName,callback:function(t){e.$set(e.editCart,"epcName",t)},expression:"editCart.epcName"}})],1),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==e.editCart.roleId,expression:"editCart.roleId==2"}],staticClass:"el-inputcss",attrs:{label:"设备限制数：",prop:"equLimitNum"}},[s("numberInput",{attrs:{"max-num":"9",placeholder:"请输入设备限制数",disabled:2==e.userType},model:{value:e.editCart.equLimitNum,callback:function(t){e.$set(e.editCart,"equLimitNum",t)},expression:"editCart.equLimitNum"}})],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"邮箱：",prop:"email"}},[s("el-input",{attrs:{maxlength:"50",placeholder:"请输入邮箱"},model:{value:e.editCart.email,callback:function(t){e.$set(e.editCart,"email",t)},expression:"editCart.email"}})],1),e._v(" "),e.editModel&&3==e.editCart.userType?s("el-form-item",{staticClass:"el-inputcss",attrs:{prop:"upperId",label:"组织："}},[s("el-cascader",{attrs:{"expand-trigger":"hover",options:e.assList.list,props:e.casProps,"show-all-levels":!1,"change-on-select":"",placeholder:"请选择组织"},on:{change:e.chonseEditOrg},model:{value:e.editBelong,callback:function(t){e.editBelong=t},expression:"editBelong"}})],1):e._e(),e._v(" "),2===e.userType&&2!=e.editCart.userType?s("el-form-item",{staticClass:"el-inputcss",attrs:{prop:"areaId",label:"区域："}},[s("el-select",{attrs:{disabled:e.editCart.id===e.userId,placeholder:"请选择区域",multiple:""},model:{value:e.editCart.areaId,callback:function(t){e.$set(e.editCart,"areaId",t)},expression:"editCart.areaId"}},e._l(e.areas,function(e){return s("el-option",{key:e.id,attrs:{label:e.areaName,value:e.id}})}),1)],1):e._e(),e._v(" "),s("el-form-item",{directives:[{name:"show",rawName:"v-show",value:3!==e.editCart.userType,expression:"editCart.userType !== 3"}],staticClass:"el-inputcss",attrs:{required:"",prop:"cloudType",label:"云服务："}},[s("el-select",{attrs:{disabled:2==e.userType,placeholder:"请选择云服务"},model:{value:e.editCart.cloudType,callback:function(t){e.$set(e.editCart,"cloudType",t)},expression:"editCart.cloudType"}},[s("el-option",{attrs:{label:"微软",value:1}}),e._v(" "),s("el-option",{attrs:{label:"阿里云",value:2}}),e._v(" "),s("el-option",{attrs:{label:"本地云",value:3}})],1)],1),e._v(" "),s("el-form-item",{staticClass:"el-inputcss",attrs:{label:"用户头像："}},[s("el-upload",{ref:"upload",staticStyle:{display:"inline"},attrs:{action:"/wuyuan/upload/uploadPicture",accept:".png, .jpg, .bmp, .gif",method:"post",data:e.headPic,"on-change":e.changeImg,"on-success":e.upLoadSuccess,"on-remove":e.uploadRemove,"before-upload":e.beforeUpload,"file-list":e.fileList,"list-type":"picture-card"}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v(e._s(e.uploadText))])],1)],1)],1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:e.toUpdate}},[e._v("确 定")])],1)],1),e._v(" "),s("user-detail",{attrs:{"user-detail":e.selectRow}}),e._v(" "),s("AssUser",{ref:"AssCartModel",attrs:{"ass-user":e.assList}})],1)},staticRenderFns:[]};var g=s("C7Lr")(m,h,!1,function(e){s("Kqnw")},"data-v-c06343d2",null);t.default=g.exports},CdUU:function(e,t){},"E+Pp":function(e,t){},Kqnw:function(e,t){},"Mj+y":function(e,t,s){"use strict";var a={model:{prop:"numData",event:"input"},props:{numData:Number|String,maxNum:{type:Number|String,default:1e3},placeholder:String,disabled:{type:Boolean,default:!1},needPoint:{type:Boolean,default:!1},needMinus:{type:Boolean,default:!1},needForce:{type:Boolean,default:!1},isError:{type:Boolean,default:!1}},data:function(){return{num:0,limitArr:[69,187]}},watch:{numData:{handler:function(e){this.num=e}}},mounted:function(){this.num=this.numData,this.needPoint||(this.limitArr=this.limitArr.concat([190,110])),this.needMinus||(this.limitArr=this.limitArr.concat([189,109]))},methods:{clickForce:function(e){this.$emit("input",e),this.needForce&&this.$forceUpdate()},noSpace:function(e){return e.returnValue=!1,!1},channelInputLimit:function(e){var t=e.keyCode;return!(t>=48&&t<=57||t>=96&&t<=105||8==t||189==t||110==t||109==t||190==t)||this.limitArr.includes(t)||e.shiftKey?(e.returnValue=!1,!1):(e.returnValue=!0,!0)},sureData:function(){this.$emit("blur",this.num),this.$emit("update:numData",0==this.num?"":this.num)}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"numberInput"}},[s("el-input",{staticClass:"el-inputcss",class:e.isError?"errorInput":"",attrs:{placeholder:e.placeholder,disabled:e.disabled,size:"small",maxlength:e.maxNum},on:{input:function(t){return e.clickForce(t)},blur:e.sureData},nativeOn:{keydown:[function(t){return e.channelInputLimit(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:e.noSpace(t)}]},model:{value:e.num,callback:function(t){e.num="string"==typeof t?t.trim():t},expression:"num"}}),e._v(" "),e._t("validator")],2)},staticRenderFns:[]};var i=s("C7Lr")(a,r,!1,function(e){s("fQZv")},"data-v-3fa3d200",null);t.a=i.exports},TVGn:function(e,t){},fQZv:function(e,t){}});