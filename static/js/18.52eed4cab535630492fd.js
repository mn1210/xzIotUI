webpackJsonp([18],{"2TW5":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={data:function(){return{currentTime:"",timingInterval:"",virtualName:"",currentTimer:"",virtualNameList:[],timingPeriodList:[{id:1,name:"5秒/次"},{id:2,name:"10秒/次"},{id:3,name:"30秒/次"},{id:4,name:"不刷新"}],myChart:"",prepare:"",without:"",total:"",queueX:[],queueY:[{y:[]},{y:[]},{y:[]}],queueLegend:["准备","未加","总共"],information:{deliverManual:0,deliverAuto:0,consumerAck:0,redelivered:0,getManualAck:0,getAutoAck:0,diskRead:0,diskWrite:0},connectData:[],queueData:[],intervalTimer:"",interval:1e3}},computed:{},created:function(){var t=this;this.currentTimer=setInterval(function(){t.currentTime=commonUtils.getNowDate()},1e3)},mounted:function(){var t=this;this.timingInterval=this.timingPeriodList[0].id,this.getVirtualList(),this.intervalTimer=setInterval(function(){t.getQueueInfo(),t.getQueueTable(),t.getConnTable()},5e3)},methods:{timingIntervalChange:function(t){var e=this;clearInterval(this.intervalTimer),4!=t?(this.interval=1==t?5*this.interval:2==t?10*this.interval:10*this.interval*3,this.intervalTimer=setInterval(function(){e.getQueueInfo(),e.getQueueTable(),e.getConnTable()},this.interval)):this.clearTime()},clearTime:function(){null!=this.intervalTimer&&(window.cancelAnimationFrame(this.intervalTimer),this.intervalTimer=null,this.interval=1e3)},selectVirtual:function(){this.getQueueTable(),this.getConnTable()},getVirtualList:function(){var t=this;this.$RequestUtil.get({url:"/monitor/mq/vhosts",params:{},success:function(e){if("success"==e.msg){for(var a=0;a<e.data.length;a++)t.virtualNameList.push({id:e.data[a].name,name:e.data[a].name});t.virtualNameList.unshift({id:"",name:"All"}),t.virtualName=t.virtualNameList[0].id}}})},getQueueInfo:function(){var t=this;this.$RequestUtil.get({url:"/monitor/mq/overview",params:{},success:function(e){if("success"==e.result){t.total=e.data.queue_totals.messages,t.without=e.data.queue_totals.messages_unacknowledged,t.prepare=e.data.queue_totals.messages_ready;var a,s,i;s=e.data.queue_totals.messages_details.samples;for(var l=0;l<s.length;l++)t.queueX.push(commonUtils.timestampToDateHMS(s[l].timestamp)),t.queueY[2].y.push(s[l].sample);a=e.data.queue_totals.messages_unacknowledged_details.samples;for(var r=0;r<a.length;r++)t.queueY[1].y.push(a[r].sample);i=e.data.queue_totals.messages_ready_details.samples;for(var n=0;n<i.length;n++)t.queueY[0].y.push(i[n].sample);0!=t.queueX.length&&t.$nextTick(function(){t.loadQueueCharts()}),t.information.deliverManual=e.data.message_stats.deliver_details.rate,t.information.deliverAuto=e.data.message_stats.deliver_no_ack_details.rate,t.information.consumerAck=e.data.message_stats.ack_details.rate,t.information.redelivered=e.data.message_stats.redeliver_details.rate,t.information.getManualAck=e.data.message_stats.get_details.rate,t.information.getAutoAck=e.data.message_stats.get_no_ack_details.rate,t.information.diskRead=e.data.message_stats.disk_reads_details.rate,t.information.diskWrite=e.data.message_stats.disk_writes_details.rate}}})},loadQueueCharts:function(){for(var t=[],e=0;e<this.queueY.length;e++){var a=this.queueY[e].y;t.push({name:this.queueLegend[e],type:"line",data:a})}this.myChart=this.$echarts.init(document.getElementById("queueCharts")),this.myChart.setOption({tooltip:{trigger:"axis"},color:["#E4C23B","#02B9EB","#CB4B4B"],legend:{icon:"none",type:"scroll",orient:"vertical",right:30,top:70,bottom:30,inactiveColor:"#D0DCE2",data:this.queueLegend,formatter:function(t){return"{a|"+t+"}"},textStyle:{rich:{a:{borderColor:"#20283B",borderWidth:20,width:100,height:15,borderRadius:2,color:"#02B9EB",lineHeight:30,align:"center",verticalAlign:"top"}}}},grid:{left:"1%",top:60,right:"28%",bottom:0,containLabel:!0},xAxis:{boundaryGap:!1,type:"category",axisTick:{show:!0},axisLine:{show:!0,onZero:!1},nameTextStyle:{color:"#a6aebd"},axisLabel:{show:!0,textStyle:{color:"#a6aebd"},inside:!1},data:this.queueX},yAxis:{type:"value",axisLine:{show:!0},axisTick:{show:!1,lineStyle:{color:"rgba(64, 68, 97, 0.6)"}},axisLabel:{textStyle:{color:"#a6aebd"}},nameTextStyle:{color:"#a6aebd"},splitLine:{lineStyle:{color:"#cccccc",type:"line"}}},series:t})},tableRowClassName:function(t){t.row;return t.rowIndex%2==1?"warning-row":"success-row"},tableHeaderColor:function(t){t.row,t.column,t.rowIndex,t.columnIndex;return"background-color:#243A4F !important;color:#fff;font-wight:500;font-size:20px;text-align:center"},getQueueTable:function(){var t=this;this.$RequestUtil.get({url:"/monitor/mq/queues?vhost="+this.virtualName,params:{},success:function(e){"success"==e.result&&(t.queueData=e.data)}}).catch(function(t){})},getConnTable:function(){var t=this;this.$RequestUtil.get({url:""==this.virtualName?"/monitor/mq/connections":"/monitor/mq/connections?vhost="+this.virtualName,params:{},success:function(e){"success"==e.result&&(t.connectData=e.data)}})}},beforeDestroy:function(){(this.currentTimer||this.intervalTimer)&&(clearInterval(this.currentTimer),clearInterval(this.intervalTimer))}},i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"jobMQ-list",attrs:{id:"jobMQlist"}},[s("div",{staticClass:"layout-div"},[s("div",{staticClass:"header-service"},[s("div",{staticClass:"service-name"},[t._v("MQ监控")]),t._v(" "),s("div",{staticClass:"service-timing"},[s("div",{staticClass:"refresher-sel"},[t._v("Refresher "+t._s(this.currentTime))]),t._v(" "),s("div",{staticClass:"service-interval"},[s("el-select",{attrs:{placeholder:"请选择定时间隔"},on:{change:t.timingIntervalChange},model:{value:t.timingInterval,callback:function(e){t.timingInterval=e},expression:"timingInterval"}},t._l(t.timingPeriodList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),s("div",{staticClass:"virtual-class"},[s("el-select",{attrs:{placeholder:"请选择虚拟机"},on:{change:t.selectVirtual},model:{value:t.virtualName,callback:function(e){t.virtualName=e},expression:"virtualName"}},t._l(t.virtualNameList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1)])]),t._v(" "),s("div",{staticClass:"queueInfo"},[s("div",{staticClass:"queue-title"},[t._v("队列信息")]),t._v(" "),0!=this.queueX.length?s("div",[t._m(0),t._v(" "),s("div",{staticClass:"charts-info-right"},[s("div",{staticClass:"charts-btn"},[s("div",{staticClass:"splie-div"}),t._v(" "),s("div",{staticClass:"charts-right"},[s("div",{staticClass:"yellow-div"},[s("div",{staticClass:"yellow-class"}),t._v(" "),s("span",{staticClass:"font-span"},[t._v(t._s(this.prepare))])]),t._v(" "),s("div",{staticClass:"blue-div"},[s("div",{staticClass:"blue-class"}),t._v(" "),s("span",{staticClass:"font-span"},[t._v(t._s(this.without))])]),t._v(" "),s("div",{staticClass:"red-div"},[s("div",{staticClass:"red-class"}),t._v(" "),s("span",{staticClass:"font-span"},[t._v(t._s(this.total))])])])])])]):s("div",{staticClass:"nodataimg"},[s("img",{staticClass:"data-img",attrs:{src:a("8H7a"),alt:""}}),t._v(" "),s("span",{staticClass:"font-color"},[t._v("暂无数据")])])]),t._v(" "),s("div",{staticClass:"information-rate"},[s("div",{staticClass:"queue-title"},[t._v("信息速率")]),t._v(" "),s("div",{staticClass:"msg-rate"},[s("div",{staticClass:"rate-list"},[s("div",{staticClass:"rate-info"},[s("div",{staticClass:"rate-name"},[t._v("Deliver (manual ack)")]),t._v(" "),s("div",{staticClass:"rate-value"},[t._v(t._s(this.information.deliverManual)+" /s ")])]),t._v(" "),s("div",{staticClass:"rate-info"},[s("div",{staticClass:"rate-name"},[t._v("Deliver (auto ack)")]),t._v(" "),s("div",{staticClass:"rate-value"},[t._v(t._s(this.information.deliverAuto)+" /s")])]),t._v(" "),s("div",{staticClass:"rate-info"},[s("div",{staticClass:"rate-name"},[t._v("Consumer ack")]),t._v(" "),s("div",{staticClass:"rate-value"},[t._v(t._s(this.information.consumerAck)+" /s")])]),t._v(" "),s("div",{staticClass:"rate-info"},[s("div",{staticClass:"rate-name"},[t._v("Redelivered")]),t._v(" "),s("div",{staticClass:"rate-value"},[t._v(t._s(this.information.redelivered)+" /s")])]),t._v(" "),s("div",{staticClass:"rate-info"},[s("div",{staticClass:"rate-name"},[t._v("Get (manual ack)")]),t._v(" "),s("div",{staticClass:"rate-value"},[t._v(t._s(this.information.getManualAck)+" /s")])]),t._v(" "),s("div",{staticClass:"rate-info"},[s("div",{staticClass:"rate-name"},[t._v("Get (auto ack)")]),t._v(" "),s("div",{staticClass:"rate-value"},[t._v(t._s(this.information.getAutoAck)+" /s")])]),t._v(" "),s("div",{staticClass:"rate-info"},[s("div",{staticClass:"rate-name"},[t._v("Disk read")]),t._v(" "),s("div",{staticClass:"rate-value"},[t._v(t._s(this.information.diskRead)+" /s")])]),t._v(" "),s("div",{staticClass:"rate-info"},[s("div",{staticClass:"rate-name"},[t._v("Disk write")]),t._v(" "),s("div",{staticClass:"rate-value"},[t._v(t._s(this.information.diskWrite)+" /s")])])])])]),t._v(" "),s("div",{staticClass:"connect-meter"},[s("div",{staticClass:"table-left"},[s("div",{staticClass:"connect-name"},[t._v("连接数表")]),t._v(" "),s("div",{staticClass:"tab-info"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.connectData,"row-class-name":t.tableRowClassName,"header-cell-style":t.tableHeaderColor}},[s("el-table-column",{attrs:{label:"概念"}},[s("el-table-column",{attrs:{prop:"vhost",label:"虚拟主机","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"userName",label:"用户名"}}),t._v(" "),s("el-table-column",{attrs:{prop:"state",label:"状态"}})],1),t._v(" "),s("el-table-column",{attrs:{label:"网络"}},[s("el-table-column",{attrs:{prop:"connTime",label:"连接时间",formatter:function(e){return t.$method.formatterTime(e.connTime)},"show-overflow-tooltip":""}})],1)],1)],1)]),t._v(" "),s("div",{staticClass:"table-right"},[s("div",{staticClass:"connect-name"},[t._v("队列表")]),t._v(" "),s("div",{staticClass:"tab-info"},[s("el-table",{staticStyle:{width:"100%"},attrs:{data:t.queueData,"row-class-name":t.tableRowClassName,"header-cell-style":t.tableHeaderColor}},[s("el-table-column",{attrs:{label:"概念"}},[s("el-table-column",{attrs:{prop:"vhost",label:"虚拟主机","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"名称","show-overflow-tooltip":""}}),t._v(" "),s("el-table-column",{attrs:{prop:"state",label:"状态"}})],1),t._v(" "),s("el-table-column",{attrs:{label:"信息"}},[s("el-table-column",{attrs:{prop:"messages",label:"准备"}}),t._v(" "),s("el-table-column",{attrs:{prop:"messagesUnacknowledged",label:"未确认"}}),t._v(" "),s("el-table-column",{attrs:{prop:"messagesReady",label:"总数","show-overflow-tooltip":""}})],1)],1)],1)])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"charts-info"},[e("div",{attrs:{id:"queueCharts"}})])}]};var l=a("C7Lr")(s,i,!1,function(t){a("m8/8"),a("nfsr")},"data-v-dd1f7434",null);e.default=l.exports},"8H7a":function(t,e,a){t.exports=a.p+"static/img/nodata.41a2963.png"},"m8/8":function(t,e){},nfsr:function(t,e){}});