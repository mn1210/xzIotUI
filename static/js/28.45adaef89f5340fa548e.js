webpackJsonp([28],{"f+zY":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("lC5x"),o=a.n(s),r=a("J0Oq"),n=a.n(r),i=a("+qDl"),l=a.n(i),c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"LogInfo"},[a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"日志详情",visible:e.$parent.detailShow,width:"600px","before-close":e.handleClose},on:{"update:visible":function(t){return e.$set(e.$parent,"detailShow",t)}}},[a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:5}},[e._v("DTU_IMEI号：")]),e._v(" "),a("el-col",{attrs:{span:7}},[e._v(e._s(e.logInfos.dtuImei))]),e._v(" "),a("el-col",{attrs:{span:5}},[e._v("设备编号：")]),e._v(" "),a("el-col",{attrs:{span:7}},[e._v(e._s(e.logInfos.equipCode))])],1),e._v(" "),a("el-row",{attrs:{type:"flex"}},[a("el-col",{attrs:{span:5}},[e._v("类型：")]),e._v(" "),a("el-col",{attrs:{span:7}},[e._v(e._s(e.logType))]),e._v(" "),a("el-col",{attrs:{span:5}},[e._v("操作内容：")]),e._v(" "),a("el-col",{attrs:{span:7}},[e._v(e._s(e.logInfos.message))])],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:5}},[e._v("操作人：")]),e._v(" "),a("el-col",{attrs:{span:7}},[e._v(e._s(e.logInfos.operatorName))])],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.toClose}},[e._v("关闭")])],1)],1)],1)},staticRenderFns:[]};var u={name:"lifecycle",components:{LogInfo:a("C7Lr")({name:"LogInfo",props:["LogInfo"],data:function(){return{detailShow:!1,logInfos:{}}},computed:{logType:function(){var e="";switch(this.logInfos.logType){case 1:e="DTU";break;case 2:e="设备管理";break;case 3:e="工单管理";break;case 4:e="指令管理";break;case 5:e="登入认证";break;case 6:e="告警规则";break;case 7:e="用户管理"}return e}},methods:{handleClose:function(e){e()},getList:function(e){this.showList=e},toClose:function(){this.$parent.detailShow=!1},getDetail:function(e){this.logInfos=e,this.getDe()},getDe:function(){var e=this;this.$RequestUtil.post({url:"/device/loginfo/getDetailOfLog",params:{id:this.logInfos.id},success:function(t){"success"===t.result?(e.logInfos=t.data,e.$parent.detailShow=!0):e.$message({type:"error",message:t.msg})}})}}},c,!1,function(e){a("gjT+")},"data-v-3dc08a74",null).exports},data:function(){return{loading:!1,detailShow:!1,searchForm:{deviceCode:"",dtuCode:"",date:[],typeVal:""},queryParams:{deviceCode:"",dtuCode:"",date:[],typeVal:"",orderColumn:"gmtCreate",orderType:"DESC"},logType:[],tableData:[],payloadDialogVisible:!1,tableCurrentPage:1,payload:[],pagination:{currentPage:1,totalPage:0,pagesize:10},showTimeRangePanel:!1,searchArr:[]}},created:function(){this.search()},computed:{labelWidth:function(){return window.innerWidth<=1366?"75px":"70px"}},mounted:function(){var e=n()(o.a.mark(function e(){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchArr=[{id:"1",label:"日志类型",value:"typeVal",type:"select",data:[]},{id:"2",label:"操作时间",value:"date",type:"date"}],e.next=3,this.searchLogType();case 3:this.searchArr[0].data=this.logType;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{sortChangeEvent:function(e){this.queryParams.orderColumn=e.order?e.prop:"gmtCreate",this.queryParams.orderType=commonUtils.changeOrderType(e.order),this.pagination.currentPage=1,this.search()},toggleTimeRangePanel:function(){this.showTimeRangePanel=!this.showTimeRangePanel},handleRangeClose:function(){this.showTimeRangePanel=!1},btnSearch:function(e){this.pagination.currentPage=1,this.queryParams.typeVal=e.typeVal,null!=e.date&&null!=e.date[0]&&null!=e.date[1]?(this.queryParams.startTime=commonUtils.timestampToDate(e.date[0]),this.queryParams.endTime=commonUtils.timestampToDate(e.date[1])):(this.queryParams.startTime="",this.queryParams.endTime=""),this.search()},pageChange:function(e){this.pagination.currentPage=e.page_index,this.pagination.pagesize=e.page_limit,this.search()},search:function(){var e=this;this.loading=!0,this.$RequestUtil.post({url:"/device/logInfo/getLogListPage",params:{page:this.pagination.currentPage,rows:this.pagination.pagesize,logType:this.queryParams.typeVal,startTime:this.queryParams.startTime,endTime:this.queryParams.endTime,orderColumn:this.queryParams.orderColumn,orderType:this.queryParams.orderType},success:function(t){"success"==t.result&&(e.tableData=t.data,e.pagination.totalPage=t.totalPages,e.loading=!1)}})},searchLogType:function(){var e=this;return this.$RequestUtil.post({url:"/device/logType/getLogTypeNoPage",params:{},success:function(t){for(var a=[],s=0;s<t.data.length;s++)a.push({value:t.data[s].typeCode,label:t.data[s].typeName});e.logType=a}})},refresh:function(){this.queryParams.date=[],this.queryParams.typeVal=""},initTable:function(){this.search()},parseTime:function(e){return e?l()(e.gmtCreate).format("YYYY-MM-DD HH:mm:ss"):""},showPayload:function(e){this.payload=JSON.parse(e.payload);for(var t=0;t<this.payload.length;t++)"Bool"==this.payload[t].TagType&&(0==this.payload[t].TagValue?this.payload[t].TagValue="false":this.payload[t].TagValue="true");this.payloadDialogVisible=!0}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-window"},[a("div",{staticStyle:{width:"100%",heigh:"100%"}},[a("div",{staticClass:"searchbar"},[a("searchInput",{attrs:{searchArr:e.searchArr},on:{clear:function(t){e.refresh()},search:function(t){e.btnSearch(t)}}})],1),e._v(" "),a("div",{staticClass:"list-div"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"default-sort":{prop:e.queryParams.orderColumn,order:"descending"}},on:{"sort-change":e.sortChangeEvent}},[a("el-table-column",{attrs:{prop:"gmtCreate",formatter:e.parseTime,label:"操作时间",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"logTypeName",label:"类型",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"message",label:"操作内容",sortable:"custom"}}),e._v(" "),a("el-table-column",{attrs:{prop:"operatorName",label:"操作人",sortable:"custom"}})],1),e._v(" "),a("Pagination",{attrs:{total:e.pagination.totalPage,"page-num":e.pagination.currentPage},on:{pageChange:e.pageChange}})],1)]),e._v(" "),a("LogInfo",{ref:"myLogInfo"})],1)},staticRenderFns:[]};var d=a("C7Lr")(u,p,!1,function(e){a("s9xl")},"data-v-775b99ae",null);t.default=d.exports},"gjT+":function(e,t){},s9xl:function(e,t){}});