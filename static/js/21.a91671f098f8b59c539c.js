webpackJsonp([21],{CPWA:function(e,t){},Zz8z:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),n=a.n(i),s=a("IHPB"),o=a.n(s),r=a("ZLEe"),l=a.n(r),d=a("lC5x"),u=a.n(d),c=a("J0Oq"),p=a.n(c),m={name:"ipaddress-input",props:{value:{type:String,default:"0.0.0.0"}},data:function(){return{ipaddressInput:[{value:"0"},{value:"0"},{value:"0"},{value:"0"}]}},watch:{value:function(e){this.ipaddressInput=e.split(".").map(function(e){return{value:e}})}},methods:{checkIpVal:function(e,t){var a=this,i=t.target.value;i=i?i.trim():i,i=parseInt(i,10),i=isNaN(i)?0:(i=i<0?0:i)>255?255:i,this.ipaddressInput[e].value=i,this.$nextTick(function(e){a.$emit("input",a.getIpAddress())})},getIpAddress:function(){for(var e=this.$refs.ipInput,t="",a=0;a<e.length;a++)0!=a&&(t+="."),t+=e[a].value;return t}}},f={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{display:"flex",width:"240px"}},e._l(e.ipaddressInput,function(t,i){return a("div",{key:i,staticStyle:{display:"flex",width:"60px"}},[a("el-input",{ref:"ipInput",refInFor:!0,attrs:{size:"mini"},nativeOn:{input:function(t){return e.checkIpVal(i,t)}},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),e._v(" "),3!=i?a("div",[e._v("-")]):e._e()],1)}),0)])},staticRenderFns:[]};var h=a("C7Lr")(m,f,!1,function(e){a("p5jz")},"data-v-7042ac3d",null).exports,g=a("E4hq"),v=a("XZht"),b={name:"devicelist",components:{IPAddressInput:h,pointConf:g.a},data:function(){return{watchNum:0,hasChange:!1,equInfo:{},equData:[],pointData:[],pointDetailData:[],protocolDialog:{isShow:!1,devices:null,configDialog:{isShow:!0,stepActive:0,ptlId:null},btns:{preBtn:{isShow:!1},nextBtn:{name:"下一步"}}},templateStyles:[{id:1,prop:"address",label:"地址"},{id:2,prop:"length",label:"长度"},{id:3,prop:"equSubId",label:"数据来源于",width:160},{id:4,prop:"dataId",label:"数据ID",width:170},{id:5,prop:"uploadStatus",label:"上传状态",width:140},{id:6,prop:"type",label:"数据类型",width:160},{id:7,prop:"bigEndian",label:"大端模式"},{id:8,prop:"bit",label:"Bit位"}],apiTemplateStyles:[{id:1,prop:"requestParams",label:"请求参数"},{id:2,prop:"requestParamsValue",label:"请求参数值",width:160},{id:3,prop:"responseParams",label:"返回参数",width:170},{id:4,prop:"equSubId",label:"数据来源于",width:160},{id:5,prop:"dataId",label:"数据ID",width:170}],editRules:{ipAddress:[{required:!0,message:"ip地址不能为空"},{validator:function(e,t,a){"0.0.0.0"==t||"1.1.1.1"==t?a("请填写正确的ip地址"):a()}}],protocol:[{required:!0,message:"请选择"},{validator:function(e,t,a){0!=t.length&&t[0]?a():a("请选择")}}],portNumber:[{required:!0,message:"不能为空"},{validator:function(e,t,a){commonUtils.regExp.portReg(t)&&0!==t?a():a("请输入正确的端口号")},trigger:"blur"}],frequency:[{required:!0,type:"number",message:"请输入正确的上传频率",trigger:"blur"},{validator:function(e,t,a){t<0?a("上传频率不能为负数"):a()},trigger:"blur"}]},configForm:{rules:{},configName:"",configInfo:"",pointConf:{},ip:"",port:"",deviceId:null,deviceCode:"",protocolId:null,protocolName:"",protocolFileName:"",templateUrl:"",templateType:""},loading:!1,dtu_id:"",myAllTree:[],token:{token:localStorage.getItem("token")},searchform:{serialnum:"",bindDtu:"",equManufacturers:"",runningStatus:"",deviceType:"",pointId:""},queryParams:{serialNum:"",equManufacturers:""},dialogTableData:{},pagination:{currentPage:1,totalPage:0},fileList:[],protocalList:{},editForm:{name:"",code:"",model:"",protocol:[],radius:"",deviceType:"",frequency:"",frequencyUnit:"second",addr:"",ipAddress:"0.0.0.0",portNumber:""},rules:{code:[{required:!0,message:"请填入设备编号",trigger:"blur"},{min:1,max:30,message:"长度在 1 到 30 个字符",trigger:"blur"},{validator:function(e,t,a){/[\u4e00-\u9fa5]/.test(t)?a(new Error("不能输入汉字")):a()},trigger:"blur"}],protocol:[{required:!0,message:"请选择协议",trigger:"blur"}],model:[{required:!0,message:"请选择设备模型",trigger:"change"}],radius:[{required:!0,validator:function(e,t,a){/^\d{1,4}(\.\d+)?$/.test(t.toString().trim())||a(new Error("请输入不超过10000的数值")),a()},trigger:"blur"}],deviceType:[{required:!0,message:"请选择设备类型",trigger:"change"}],addr:[{required:!0,message:"请输入设备地址",trigger:"blur"}]},add_dialogVisible:!1,edit_dialogVisible:!1,pointTableData:[{index:1,arr:[{name:"采集块ID",value:"",font:"collectId",maxLen:"10"},{name:"设备地址",value:"",font:"slaveAddr",maxLen:"9"},{name:"采集块起始地址",value:"",font:"startAddr",maxLen:"9"}]}],unfinishedTableData:[{index:1,arr:[{name:"采集块ID",value:"",font:"collectId",maxLen:"10"},{name:"设备地址",value:"",font:"slaveAddr",maxLen:"9"},{name:"采集块起始地址",value:"",font:"startAddr",maxLen:"9"}]}],showTableIndex:[1],showDialogTableIndex:[1],tdNum:{},cpNum:0,clickIndex:0,allTableIndex:[],detailVisible:!1,hasUnfinished:!1,dataTypeArr:[{label:"布尔量",value:"1"},{label:"无符号单字节",value:"2"},{label:"有符号单字节",value:"3"},{label:"无符号单字",value:"4"},{label:"有符号单字",value:"5"},{label:"有符号双字",value:"6"},{label:"无符号双字",value:"7"},{label:"32位浮点型",value:"8"}],uploadArr:[{label:"定时上传",value:"1"},{label:"差异上传",value:"2"},{label:"定时且差异",value:"3"}],notLeave:!1,oldCheckValue:[],unfinishedPro:[{label:"设备编号：",value:"",id:1,code:"equCode"},{label:"设备名称：",value:"",id:2,code:"equName"},{label:"协议组：",value:"",id:3,code:"protocol"},{label:"ip地址：",value:"",id:4,code:"ipAddress"},{label:"端口号：",value:"",id:5,code:"portNumber"},{label:"上传频率：",value:"",id:6,code:"frequency"}],singlePointId:"",pointRowH:370,registerPointData:[],isAllPoint:!0,isMessage:!1,isSave:!1,showTable:!0}},computed:{setTemplateUrl:function(){return"/wuyuan/device/equipment/exportEquipmentTemplate?token="+localStorage.getItem("token")},setUploadUrl:function(){return"/wuyuan/resource/loadPointConfigTemplate?type=1"},dialogWidth:function(){return window.innerWidth<=1366?"80%":"75%"},whichTemplateStyles:function(){return 4===this.equInfo.nodeType?this.apiTemplateStyles:this.templateStyles},frequencyM:function(){var e=this.editForm.frequency;switch(this.editForm.frequencyUnit){case"second":e/=60;break;case"hour":e*=60;break;case"day":e=60*e*24}return e}},watch:{pointTableData:{handler:function(e,t){this.allTableIndex=e.map(function(e){return e.index})},deep:!0},editForm:{deep:!0,handler:function(e,t){this.watchNum++,this.watchNum>1&&!this.hasChange&&(this.hasChange=!0)}}},mounted:function(){var e=p()(u.a.mark(function e(){var t=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.next=3,this.$RequestUtil.post({url:"/device/protocol/getProtocolTree",params:{},success:function(e){t.$set(t.protocalList,"data",e.data.tree.children),t.checkTree(t.myAllTree,t.protocalList.data),"fail"===e.result&&t.$message({type:"error",message:e.msg})}});case 3:return e.next=5,this.search();case 5:if(this.equData.push(this.equInfo),1!==this.equInfo.nodeType&&4!==this.equInfo.nodeType){e.next=9;break}return e.next=9,this.$RequestUtil.post({url:"/device/equipment/getEquipmentList",params:{nodeType:2,id:this.equInfo.id},success:function(e){t.equData=t.equData.concat(e.data),"fail"===e.result&&t.$message({type:"error",message:e.msg})}});case 9:this.pointSearch("mounted"),this.$RequestUtil.post({url:"/device/pointTemplate/getPointManageList",params:{},success:function(e){var a=[],i=[];e.data.forEach(function(e){1==e.scopeType&&a.push(e),2==e.scopeType&&i.push(e)}),t.pointData=a,t.registerPointData=i,"fail"===e.result&&t.$message({type:"error",message:e.msg})}}),Object(v.b)(document.getElementById("pointRow"),this.resizePointRow),window.onbeforeunload=function(e){if(t.hasChange)return(e=e||window.event).returnValue="当前页面有修改，确认离开？","当前页面有修改，确认离开？"};case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),beforeDestroy:function(){},methods:{addUnload:function(){var e=this,t=setTimeout(function(){window.onbeforeunload=function(t){if(e.hasChange)return(t=t||window.event).returnValue="当前页面有修改，确认离开？","当前页面有修改，确认离开？"},clearTimeout(t),t=null},1e3)},removeUnload:function(){window.onbeforeunload=null},resizePointRow:function(){this.pointRowH=window.innerWidth<=1366?370:document.getElementById("pointRow").offsetHeight},clickInput:function(){this.$forceUpdate()},pointSearch:function(e){var t=this;this.$RequestUtil.post({url:"/device/equipment/getEquipmentPointDetail",params:{equId:this.$route.query.id},success:function(a){if("fail"!==a.result){t.pointTableData=[{index:1,arr:[{name:"采集块ID",value:"",font:"collectId",maxLen:"10"},{name:"设备地址",value:"",font:"slaveAddr",maxLen:"9"},{name:"采集块起始地址",value:"",font:"startAddr",maxLen:"9"}]}];var i=a.data[0]?a.data[0]:a.data[3]?a.data[3]:[];i&&0!=i.length?t.getPointConfData(i,e,"finished"):t.$nextTick(function(){t.$refs.pointTable1&&t.$refs.pointTable1.addTD(1)}),a.data[1]&&0!=a.data[1].length&&(t.detailVisible=!0,t.hasUnfinished=!0,t.getPointConfData(a.data[1],e,"unfinished")),t.loading=!1,"add"==e&&(t.hasChange=!1)}else t.$message({type:"error",message:a.msg})}})},getSamePointData:function(e){for(var t={},a=[],i=1,n=0;n<e.length;n++){var s=e[n],o=e[n+1];s.collectId+s.slaveAddr+s.startAddr==(e[n+1]?o.collectId+o.slaveAddr+o.startAddr:"")?a.push(e[n]):(a.push(e[n]),t[i]=a.concat(),i++,a=[])}return t},getPointTableData:function(e,t){var a={index:t+1,arr:[{name:"采集块ID",value:"",font:"collectId",maxLen:"10"},{name:"设备地址",value:"",font:"slaveAddr",maxLen:"9"},{name:"采集块起始地址",value:"",font:"startAddr",maxLen:"9"}]};return a.arr[0].value=e[0].collectId,a.arr[1].value=e[0].slaveAddr,a.arr[2].value=e[0].startAddr,this.showTableIndex.indexOf(t+1)<0&&(this.showTableIndex.push(t+1),this.allTableIndex.push(t+1)),a},getPointConfData:function(e,t,a){var i=this,s={},r={};"finished"!=a&&(this.dialogTableData={}),e.sort(function(e,t){return e.collectId-t.collectId});var d=this.getSamePointData(e),u=0,c=0,p=0;l()(d).forEach(function(e){"finished"==a?(i.tdNum[e]=d[e].length,i.pointTableData[u]=i.getPointTableData(d[e],u),r[e]=d[e].reduce(function(e,a){return["null","undefined",""].includes(String(a.dataId))?c++:(a.equSubId=a.equSubId||a.equCode,a.bigEndian=Boolean(a.bigEndian),a.type=Number(a.type),"upload"!=t&&(a.timerState=Boolean(a.timerState),a.realtimeState=Boolean(a.realtimeState)),a.uploadStatus=String(a.uploadStatus)),["null","undefined",""].includes(String(a.dataId))?e:[].concat(o()(e),[a])},[])):(i.unfinishedTableData[u]=i.getPointTableData(d[e],u),s[e]=d[e].reduce(function(e,a){return["null","undefined",""].includes(String(a.dataId))?p++:(a.equSubId=a.equSubId||a.equCode,a.type=Number(a.type),"upload"!=t&&(a.timerState=Boolean(a.timerState),a.realtimeState=Boolean(a.realtimeState))),["null","undefined",""].includes(String(a.dataId))?e:[].concat(o()(e),[a])},[])),u++}),"finished"==a?(c>0&&this.messageShow(c,"finished"),this.configForm.pointConf=r):(p>0&&this.messageShow(p,"unFinished"),this.dialogTableData=s);var m={equ:this.equInfo.equCode,finished:c,unFinished:p},f=localStorage.getItem("emptyNum")?JSON.parse(localStorage.getItem("emptyNum")):{};f[this.equInfo.equCode]=m,localStorage.setItem("emptyNum",n()(f)),this.cpNum=Math.random(),this.$nextTick(function(){i.$refs.pointTable&&i.$refs.pointTable.clearRules()}),"add"==t&&(this.hasChange=!1)},messageShow:function(e,t){if(!this.isMessage){if(localStorage.getItem("emptyNum"))e!=JSON.parse(localStorage.getItem("emptyNum"))[this.equInfo.equCode][t]&&(this.$message({message:"受KPI影响，当前点位已更新",type:"warning"}),this.isMessage=!0);!localStorage.getItem("emptyNum")&&e>0&&(this.$message({message:"受KPI影响，当前点位已更新",type:"warning"}),this.isMessage=!0)}},pointDetail:function(e,t,a,i){var n=this;this.$RequestUtil.post({url:"/device/pointTemplate/getPointDetailData",params:{pointId:t},success:function(e){"fail"!==e.result?("collect"==a?(n.isAllPoint=!0,n.singlePointId="",n.getPointConfData(e.data,"mounted","finished")):(n.isAllPoint=!1,n.singlePointDetail(e.data,i)),n.hasChange=!0):n.$message({type:"error",message:e.msg})}})},singlePointDetail:function(e,t){var a=this,i={};i[t]=e.map(function(e){return{address:e.address,length:String(e.length),equSubId:e.equSubId,dataId:e.dataId,uploadStatus:String(e.uploadStatus),type:e.type,bigEndian:e.bigEndian,bit:e.bit}}),this.configForm.pointConf=i,this.hasChange=!0,this.tableData=this.configForm.pointConf,this.cpNum=Math.random(),this.$nextTick(function(){a.$refs.pointTable.clearRules()})},beforeUpload:function(e){if(e.size>10485760)return this.$message.error("文件不能大于10M"),!1},upLoadSuccess:function(e,t,a){if("success"!=e.result)this.$message({type:"error",message:e.msg}),this.$refs.upload.clearFiles();else{this.hasChange=!0;var i={"定时上传":"1","差异上传":"2","定时且差异":"3"},n={"布尔量":1,"无符号单字节":2,"有符号单字节":3,"无符号单字":4,"有符号单字":5,"无符号双字":6,"有符号双字":7,"32位浮点型":8};e.data.forEach(function(e){switch("是"==e.大端模式?e.大端模式=!0:e.大端模式=!1,e.上传状态=i[e.上传状态],e.数据类型=n[e.数据类型],e.数据类型){case 1:case 2:case 3:e.length=1;break;case 4:case 5:e.length=2;break;case 6:case 7:case 8:e.length=4;break;default:e.length=""}}),e.data;var s={"地址":"address","采集块ID":"collectId","长度":"length","数据ID":"dataId","设备地址":"slaveAddr","数据类型":"type","Bit位":"bit","数据来源于(编号)":"equSubId","大端模式":"bigEndian","上传状态":"uploadStatus","采集块起始地址":"startAddr"},o=e.data.map(function(e){return commonUtils.toChsKeys(e,s)});0!=o.length&&(this.errorMsg={},this.getPointConfData(o,"upload","finished"))}},queryAddrAsync:function(e,t){this.$method.amapPOI(e).then(function(e){t(e.data.pois.map(function(e){return{value:e.name}}))})},search:function(e){var t=this;return this.$RequestUtil.post({url:"/device/equipment/infoToEquipment",params:{id:this.$route.query.id},success:function(a){var i={},n={};0!=a.data.list.length&&a.data.list.forEach(function(e){i=0===e.preinstall||3===e.preinstall?e:i,n=1==e.preinstall?e:n}),t.equInfo=a.data,t.editForm.ipAddress=i&&i.ipAddress?i.ipAddress:"0.0.0.0",t.editForm.portNumber=i&&i.portNumber?i.portNumber:0,t.editForm.frequency=i&&i.frequency?Number(i.frequency):0,t.editForm.frequencyUnit=i&&i.frequencyUnit?i.frequencyUnit:"second",i?t.getProtocalInfo(i.protocolId):t.editForm.protocol=[],n&&t.unfinishedPro.forEach(function(e){e.value="protocol"==e.code?n.protocolName:"frequency"==e.code?n[e.code]+t.transFU(n.frequencyUnit):["portNumber","ipAddress"].includes(e.code)?n[e.code]:a.data[e.code]}),e&&"refresh"==e&&(t.hasChange=!1)}})},transFU:function(e){var t=void 0;switch(e){case"second":t="秒";break;case"minute":t="分钟";break;case"hour":t="小时";break;case"day":t="天"}return t},refresh:function(){this.pagination.currentPage=1,this.queryParams.serialNum="",this.queryParams.equManufacturers="",this.showTable=!0,this.search("refresh"),this.hasChange=!1},getExportTemplate:function(){document.getElementById("ifile").src="/device/equipment/exportEquipmentTemplate?token="+localStorage.getItem("token")},sureAdd:function(){var e=this;this.isAllPoint=!0;var t=this;this.$refs.baseForm.validate(function(a){if(a){if(e.frequencyM>e.equInfo.offLineDuration)return void e.$message.error("上传频率不能超过DTU离线间隔时间（"+e.equInfo.offLineDuration+"）分钟");e.$refs.pointTable1.beforeSubmit().then(function(a){var i=a;0!=a.length?t.$RequestUtil.postSync({url:"/device/equipment/updateEquipmentDetail",params:{equId:t.$route.query.id,protocolId:t.editForm.protocol[t.editForm.protocol.length-1],ipAddress:t.editForm.ipAddress,portNumber:t.editForm.portNumber,frequencyUnit:t.editForm.frequencyUnit,equipmentPointList:i,frequency:t.editForm.frequency,equNodeType:t.equInfo.nodeType,equCode:t.equInfo.equCode},type:"sync",success:function(a){if("success"===a.result){e.showTable=!1,t.$eventBus.$emit("triggerMsg",a.data),t.$message({type:"success",message:a.msg});t.add_dialogVisible=!1,e.isSave=!0;var i=setTimeout(function(){t.refresh(),clearTimeout(i)},100);t.pointSearch("add"),e.watchNum=0,e.configForm.pointConf={}}else"fail"===a.result?t.$message({type:"error",message:a.msg}):"warn"===a.result&&t.$message({type:"warning",message:a.msg})}}):e.$message.error("请至少增加一行设备点位")})}})},changeHasChange:function(){var e=this;if(this.hasChange=!this.isSave,1==this.isSave)var t=setTimeout(function(){e.isSave=!1,clearTimeout(t)},1e3)},checkTree:function(e,t){for(var a in t)e.push({id:t[a].id,pid:t[a].pId}),null!=t[a].children&&t[a].children.length>0&&this.checkTree(e,t[a].children)},getProtocalInfo:function(e){this.editForm.protocol=[];var t=0;for(var a in this.myAllTree)if(e==this.myAllTree[a].id){t=this.myAllTree[a].pid;break}this.editForm.protocol.unshift(e),this.getParentId(this.editForm.protocol,t)},getParentId:function(e,t){for(var a in this.myAllTree){if(1===t)return;if(t===this.myAllTree[a].id){e.unshift(this.myAllTree[a].id),this.getParentId(e,this.myAllTree[a].pid);break}}}},beforeRouteLeave:function(e,t,a){var i=this;if(this.hasChange){var n=setTimeout(function(){i.$confirm("当前页面有修改，确认离开？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a()}).catch(function(){}),clearTimeout(n),n=null},300);Object(v.a)(document.getElementById("pointRow"),this.resizePointRow),window.onbeforeunload=null}else a()}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"list-window",class:e.pointRowH>500?"listWindowPR":""},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"searchbar"},[a("el-form",{ref:"baseForm",staticClass:"demo-form-inline",attrs:{rules:e.editRules,inline:!0,model:e.editForm,"label-width":"100px","label-position":"left"}},[a("el-row",{staticStyle:{padding:"10px 10px"}},[a("span",{staticClass:"bigTitle"},[e._v("基本信息")])]),e._v(" "),a("el-row",{staticClass:"searchPad"},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"设备编号："}},[a("span",{staticClass:"line-span"},[e._v(e._s(e.equInfo.equCode))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"设备名称："}},[a("span",{staticClass:"line-span"},[e._v(e._s(e.equInfo.equName))])])],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{ref:"prot",attrs:{label:"协议组：",prop:"protocol"}},[a("el-cascader",{ref:"cas",staticClass:"form__input",attrs:{placeholder:"请选择协议组",options:e.protocalList.data,props:{value:"id",label:"label",children:"children"},"show-all-levels":!1},model:{value:e.editForm.protocol,callback:function(t){e.$set(e.editForm,"protocol",t)},expression:"editForm.protocol"}})],1)],1)],1),e._v(" "),a("el-row",{staticClass:"searchPad"},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"ip地址：","label-width":"100px",prop:"ipAddress"}},[a("IPAddressInput",{model:{value:e.editForm.ipAddress,callback:function(t){e.$set(e.editForm,"ipAddress",t)},expression:"editForm.ipAddress"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"端口号：",prop:"portNumber"}},[a("el-input",{staticClass:"form__input port",attrs:{placeholder:"请输入端口号",size:"small",maxlength:"15"},model:{value:e.editForm.portNumber,callback:function(t){e.$set(e.editForm,"portNumber",t)},expression:"editForm.portNumber"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"上传频率：",prop:"frequency"}},[a("el-input",{staticClass:"form__input input-with-select",attrs:{size:"small",maxlength:"9"},model:{value:e.editForm.frequency,callback:function(t){e.$set(e.editForm,"frequency",e._n(t))},expression:"editForm.frequency"}},[a("el-select",{attrs:{slot:"append",placeholder:"请选择上传频率"},slot:"append",model:{value:e.editForm.frequencyUnit,callback:function(t){e.$set(e.editForm,"frequencyUnit",t)},expression:"editForm.frequencyUnit"}},[a("el-option",{attrs:{label:"秒",value:"second"}}),e._v(" "),a("el-option",{attrs:{label:"分钟",value:"minute"}}),e._v(" "),a("el-option",{attrs:{label:"小时",value:"hour"}}),e._v(" "),a("el-option",{attrs:{label:"天",value:"day"}})],1)],1)],1)],1)],1)],1),e._v(" "),a("el-row",{staticStyle:{padding:"10px 10px"}},[a("span",{staticClass:"bigTitle"},[e._v("设备点位")])]),e._v(" "),a("el-row",{staticStyle:{padding:"10px 40px"}},[a("el-row",{staticStyle:{padding:"5px 5px"}},[a("a",{staticClass:"marRight10",attrs:{href:e.setTemplateUrl}},[a("el-button",{attrs:{size:"small"},nativeOn:{mousedown:function(t){return e.removeUnload(t)},mouseup:function(t){return e.addUnload(t)}}},[e._v("模板下载")])],1),e._v(" "),a("el-upload",{ref:"upload",staticClass:"marRight10",staticStyle:{display:"inline"},attrs:{action:e.setUploadUrl,"show-file-list":!1,method:"post",accept:".xlsx","before-upload":e.beforeUpload,"on-success":e.upLoadSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择文件")])],1),e._v(" "),a("div",{staticStyle:{display:"inline-block","text-align":"center","font-size":"13px",color:"#606266"}},[e._v("系统全点位模板选择：")]),e._v(" "),a("el-select",{staticClass:"form__input marRight10",on:{change:function(t){return e.pointDetail(t,e.searchform.pointId,"collect","")}},model:{value:e.searchform.pointId,callback:function(t){e.$set(e.searchform,"pointId",t)},expression:"searchform.pointId"}},e._l(e.pointData,function(e){return a("el-option",{key:e.id,attrs:{label:e.pointName,value:e.id}})}),1),e._v(" "),a("el-button",{directives:[{name:"show",rawName:"v-show",value:e.hasUnfinished,expression:"hasUnfinished"}],staticClass:"marRight10",attrs:{plain:"",type:"primary",size:"small"},on:{click:function(t){e.detailVisible=!0}}},[e._v("\n          未完成点位配置详情\n        ")])],1),e._v(" "),a("el-row",{staticStyle:{padding:"5px 5px"},attrs:{id:"pointRow"}},[e.showTable?a("pointConf",{ref:"pointTable1",attrs:{"point-conf-item-data":e.pointTableData,"show-table-index":e.showTableIndex,"conf-template-styles":e.whichTemplateStyles,"point-config-form":e.configForm.pointConf,"equ-data":e.equData,"now-td-num":e.tdNum,"validate-collect":e.isAllPoint,"is-add":e.hasChange,"is-save":e.isSave},on:{clickAddTd:function(t){e.clickIndex=t},isChange:e.changeHasChange},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"flexCenter singlePoint"},[e._v("系统寄存器模板选择：")]),e._v(" "),a("el-select",{staticClass:"singleInput  marRight10",on:{change:function(a){return e.pointDetail(a,e.singlePointId,"single",t.index)}},model:{value:e.singlePointId,callback:function(t){e.singlePointId=t},expression:"singlePointId"}},e._l(e.registerPointData,function(e){return a("el-option",{key:e.id,attrs:{label:e.pointName,value:e.id}})}),1)]}}],null,!1,1085740075)}):e._e(),e._v(" "),a("div",{staticStyle:{width:"100%","text-align":"center","margin-top":"20px"}},[a("el-button",{attrs:{type:"primary"},on:{click:e.sureAdd}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"detailDialog",attrs:{"close-on-click-modal":!1,visible:e.detailVisible,width:e.dialogWidth},on:{"update:visible":function(t){e.detailVisible=t}}},[a("template",{slot:"title"},[a("div",{},[a("span",{staticClass:"detailBigTitle"},[e._v("未完成点位详情")]),e._v(" "),a("span",{staticClass:"detailSmallTitle"},[e._v("(关闭后可点击相应按钮打开)")])])]),e._v(" "),a("div",{staticClass:"flexBox flexWrap basic"},e._l(e.unfinishedPro,function(t){return a("div",{key:t.id,staticClass:"unProDiv"},[a("span",{class:[1,2,4,5].includes(t.id)?"title":"title2"},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticClass:"content"},[e._v(e._s(t.value))])])}),0),e._v(" "),a("pointConf",{ref:"pointTable",staticClass:"detailScroll",attrs:{"point-conf-item-data":e.unfinishedTableData,"show-table-index":e.showDialogTableIndex,"conf-template-styles":e.whichTemplateStyles,"point-config-form":e.dialogTableData,"need-scroll":!0,"has-collect":!0,"is-read-only":!0}})],2)],1)},staticRenderFns:[]};var I=a("C7Lr")(b,y,!1,function(e){a("CPWA"),a("dtiz")},"data-v-36bef44e",null);t.default=I.exports},dtiz:function(e,t){},p5jz:function(e,t){}});