webpackJsonp([41],{"7fAN":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r={name:"alarmPush",mixins:[t("i7Lb").a],data:function(){return{queryParams:{sendTemplateCode:"",sendType:"",alarmSendStatus:"",timeRange:[],orderColumn:"sendTime",orderType:"DESC"},sendType:{1:"短信",2:"邮件"},alarmSendStatus:{0:"未推送",1:"已推送",2:"推送失败"}}},mounted:function(){this.searchArr=[{id:"1",label:"模板编号",value:"sendTemplateCode",type:"input",maxLen:"50"},{id:"2",label:"推送类型",value:"sendType",type:"select",data:[{value:"1",label:"短信"},{value:"2",label:"邮件"}]},{id:"3",label:"推送状态",value:"alarmSendStatus",type:"select",data:[{value:"0",label:"未推送"},{value:"1",label:"已推送"},{value:"2",label:"推送失败"}]},{id:"4",label:"推送时间",value:"timeRange",type:"date"}],this.search()},methods:{sortChangeEvent:function(e){this.queryParams.orderColumn=e.order?e.prop:"sendTime",this.queryParams.orderType=commonUtils.changeOrderType(e.order),this.pagination.currentPage=1,this.search()},search:function(){var e=this;this.loading=!0,this.$RequestUtil.post({url:"/alarm/alarmSend/listAlarmSendDataPage",params:{page:this.pagination.currentPage,rows:this.pagination.pagesize,sendTemplateCode:this.queryParams.sendTemplateCode,sendType:this.queryParams.sendType,alarmSendStatus:this.queryParams.alarmSendStatus,startDate:this.queryParams.timeRange[0]?commonUtils.timestampToDate(new Date(this.queryParams.timeRange[0]).getTime()):"",endDate:this.queryParams.timeRange[1]?commonUtils.timestampToDate(new Date(this.queryParams.timeRange[1]).getTime()):"",orderColumn:this.queryParams.orderColumn,orderType:this.queryParams.orderType},success:function(a){e.tableData=a.data,e.pagination.totalPage=a.totalPages,e.loading=!1,e.$nextTick(function(){})}}).catch(function(){e.loading=!1})},reSend:function(e){var a=this;this.$RequestUtil.post({url:"/alarm/alarmSend/updateAlarmSendDate",params:{id:e.id},success:function(e){a.$message({type:"success",message:e.msg})}})}}},s={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"list-window"},[t("div",{staticClass:"searchbar"},[t("searchInput",{attrs:{"search-arr":e.searchArr},on:{clear:function(a){e.clearPart(a)},search:function(a){e.searchPart(a)},querySelect:function(a){var t=a.queryString,r=a.cb;e.queryBindDtu(t,r)}}})],1),e._v(" "),t("div",{staticClass:"list-div"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-row-class-name":"table-header-color","default-sort":{prop:e.queryParams.orderColumn,order:"descending"}},on:{"sort-change":e.sortChangeEvent}},[t("el-table-column",{attrs:{width:"105px",sortable:"custom",label:"推送类型",prop:"sendType",formatter:function(a){return e.sendType[a.sendType]}}}),e._v(" "),t("el-table-column",{attrs:{width:"120px",sortable:"custom",label:"模板编号",prop:"sendTemplateCode"}}),e._v(" "),t("el-table-column",{attrs:{"min-width":"200px",sortable:"custom",label:"推送内容",prop:"alarmSendInfo"}}),e._v(" "),t("el-table-column",{attrs:{width:"105px",sortable:"custom",label:"推送状态",prop:"alarmSendStatus"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{style:{color:2===a.row.alarmSendStatus?"red":null}},[e._v(e._s(e.alarmSendStatus[a.row.alarmSendStatus]))])]}}])}),e._v(" "),t("el-table-column",{attrs:{width:"105px",sortable:"custom",label:"接收人",prop:"reciverName"}}),e._v(" "),t("el-table-column",{attrs:{width:"170px",sortable:"custom",label:"接收人手机或邮箱",prop:"reciverAddress"}}),e._v(" "),t("el-table-column",{attrs:{width:"120px",sortable:"custom",label:"推送时间",prop:"sendTime"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",[e._v(e._s(e._f("moment")(a.row.sendTime)))])]}}])}),e._v(" "),t("el-table-column",{attrs:{width:"105px",sortable:"custom",label:"错误信息",prop:"errorMessage"}}),e._v(" "),e.$PERMISSION.UPDATE_ALARM_SEND_DATE?t("el-table-column",{attrs:{width:"105px",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{disabled:2!==a.row.alarmSendStatus,type:"text",size:"mini"},on:{click:function(t){return e.reSend(a.row)}}},[e._v("重发")])]}}],null,!1,1935826648)}):e._e()],1),e._v(" "),t("Pagination",{attrs:{total:e.pagination.totalPage,"page-num":e.pagination.currentPage},on:{pageChange:e.pageChange}})],1)])},staticRenderFns:[]};var n=t("C7Lr")(r,s,!1,function(e){t("7yb0")},"data-v-670b2ac1",null);a.default=n.exports},"7yb0":function(e,a){}});