webpackJsonp([45],{Niiv:function(e,t){},RgVK:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("i7Lb"),l=i("lC5x"),n=i.n(l),o=i("J0Oq"),s=i.n(o),r=i("KrkU"),c={listEquipmentType:function(){var e=this;return s()(n.a.mark(function t(){var i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.post({url:"/device/equipmentType/getEquipmentTypeList",params:{}});case 2:return i=e.sent,e.abrupt("return",i.data);case 4:case"end":return e.stop()}},t,e)}))()}},d={name:"checkConf",mixins:[a.a],data:function(){return{add_dialogVisible:!1,editDialogVisible:!1,viewDialogVisible:!1,queryParams:{sendTemplateCode:"",orderColumn:"gmtModified",orderType:"DESC"},actType:["目视","耳听","鼻嗅","手触","口尝","其他"],levelOption:[{label:"一级",value:1},{label:"二级",value:2},{label:"三级",value:3}],deviceType:[],addForm:{configName:"",workingLevel:"",deviceTypeId:null,inspectionConfigDetailList:[]},rules:{configName:[{required:!0,message:"请输入点检名称",trigger:"blur"},{validator:function(e,t,i){0==t.trim().length?i(new Error("点检名称不能为空")):t.trim().length!=t.length?i(new Error("点检名称不能以空格开始或结束")):i()},trigger:"blur"}],content:[{required:!0,message:"请输入检点内容",trigger:"blur"}],criterion:[{required:!0,message:"请输入检查标准",trigger:"blur"}],workingLevel:[{required:!0,message:"请选择保养级别",trigger:"blur"}],deviceTypeId:[{required:!0,message:"请选择设备类型",trigger:"blur"}]}}},mounted:function(){var e=this;this.searchArr=[{id:"1",label:"点检名称",value:"sendTemplateCode",type:"input",maxLen:"50"}],c.listEquipmentType().then(function(t){e.deviceType=t.data}),this.search()},methods:{sortChangeEvent:function(e){this.queryParams.orderColumn=e.order?e.prop:"gmtModified",this.queryParams.orderType=commonUtils.changeOrderType(e.order),this.pagination.currentPage=1,this.search()},search:function(){var e=this;this.loading=!0,this.$RequestUtil.post({url:"/device/inspectionConfig/getInspectionConfigPage",params:{page:this.pagination.currentPage,rows:this.pagination.pagesize,configName:this.queryParams.sendTemplateCode,orderType:this.queryParams.orderType,orderColumn:this.queryParams.orderColumn},success:function(t){e.tableData=t.data,e.pagination.totalPage=t.totalPages,e.loading=!1}}).catch(function(){e.loading=!1})},cancelAddDialog:function(){this.addDialogVisible=!1,this.addForm={configName:"",workingLevel:"",deviceTypeId:null,inspectionConfigDetailList:[]}},cancelEditDialog:function(){this.editDialogVisible=!1,this.addForm={configName:"",workingLevel:"",deviceTypeId:null,id:null,inspectionConfigDetailList:[],oldDeviceTypeId:null}},cancelViewDialog:function(){this.viewDialogVisible=!1,this.addForm={configName:"",workingLevel:"",deviceTypeId:null,id:null,inspectionConfigDetailList:[]}},removeDetail:function(e){this.addForm.inspectionConfigDetailList.splice(e,1)},addDetailList:function(){var e=this,t={inspectWay:"目视",id:null,configId:null},i=this.addForm.inspectionConfigDetailList.length;this.addForm.inspectionConfigDetailList.push(t),setTimeout(function(){e.$refs["focusprocedure"+i].focus()},0)},submitAddDialog:function(){var e=this;this.$refs.addForm.validate(function(t){if(t){if(0==e.addForm.inspectionConfigDetailList.length)return void e.$message.warning("点检配置项不能为空");e.$RequestUtil.post({url:"/device/inspectionConfig/addInspectionConfig",params:e.addForm,success:function(t){e.$message.success("添加成功"),e.add_dialogVisible=!1,e.search(),e.addForm={configName:"",workingLevel:"",deviceTypeId:null,inspectionConfigDetailList:[]}}})}})},showEditDialog:function(e){this.editDialogVisible=!0,this.addForm.configName=e.configName,this.addForm.inspectionConfigDetailList=commonUtils.cloneObj(e.inspectionConfigDetailList),this.addForm.oldDeviceTypeId=e.deviceTypeId,this.addForm.deviceTypeId=e.deviceTypeId,this.addForm.id=e.id,this.addForm.workingLevel=e.workingLevel},showViewDialog:function(e){this.viewDialogVisible=!0,this.addForm.configName=e.configName,this.addForm.inspectionConfigDetailList=e.inspectionConfigDetailList,this.addForm.deviceTypeId=e.deviceTypeId,this.addForm.id=e.id,this.addForm.workingLevel=e.workingLevel,this.addForm.typeName=e.typeName},submitEditDialog:function(){var e=this;this.$refs.editForm.validate(function(t){if(t){if(0==e.addForm.inspectionConfigDetailList.length)return void e.$message.warning("点检配置项不能为空");e.addForm.deviceTypeId=e.addForm.oldDeviceTypeId,e.$RequestUtil.post({url:"/device/inspectionConfig/updateInspectionConfig",params:e.addForm,success:function(t){e.$message.success("编辑成功"),e.editDialogVisible=!1,e.search(),e.addForm={configName:"",workingLevel:"",deviceTypeId:null,id:null,inspectionConfigDetailList:[],oldDeviceTypeId:null}}})}})},deleteConfig:function(e){var t=this;this.$confirm("此操作将删除该点检配置, 删除后不可撤销，是否继续?","提示",{cancelButtonClass:"btn-custom-cancel",showCancelButton:!1,confirmButtonText:"确定",type:"warning"}).then(function(){t.$RequestUtil.post({url:"/device/inspectionConfig/deleteInspectionConfig",params:{id:e.id},success:function(e){t.$message({type:"success",message:"删除成功!"}),t.search()}})})}}},u={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"list-window"},[i("div",{staticClass:"searchbar"},[i("searchInput",{attrs:{"search-arr":e.searchArr},on:{clear:function(t){e.clearPart(t)},search:function(t){e.searchPart(t)},querySelect:function(t){var i=t.queryString,a=t.cb;e.queryBindDtu(i,a)}}})],1),e._v(" "),e.$PERMISSION.INSPECTION_CONFIG_WRITE?i("div",{staticClass:"operatebar"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(){return e.add_dialogVisible=!0}}},[e._v("新增点检")])],1):e._e(),e._v(" "),i("div",{staticClass:"list-div"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-row-class-name":"table-header-color"},on:{"sort-change":e.sortChangeEvent}},[i("el-table-column",{attrs:{label:"点检名称",prop:"configName",sortable:"custom"}}),e._v(" "),i("el-table-column",{attrs:{label:"设备品类",prop:"typeName",sortable:"custom"}}),e._v(" "),i("el-table-column",{attrs:{label:"使用级别",prop:"workingLevel",sortable:"custom"}}),e._v(" "),i("el-table-column",{attrs:{label:"创建时间",prop:"gmtCreate",sortable:"custom"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(e._f("moment")(t.row.gmtCreate)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.showViewDialog(t.row)}}},[e._v("查看")]),e._v(" "),e.$PERMISSION.INSPECTION_CONFIG_WRITE?i("span",{staticClass:"vertical"}):e._e(),e._v(" "),e.$PERMISSION.INSPECTION_CONFIG_WRITE?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.showEditDialog(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),e.$PERMISSION.INSPECTION_CONFIG_WRITE?i("span",{staticClass:"vertical"}):e._e(),e._v(" "),e.$PERMISSION.INSPECTION_CONFIG_WRITE?i("el-button",{attrs:{type:"text",size:"small"},on:{click:function(i){return e.deleteConfig(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),i("Pagination",{attrs:{total:e.pagination.totalPage,"page-num":e.pagination.currentPage},on:{pageChange:e.pageChange}})],1),e._v(" "),i("el-dialog",{attrs:{title:"新增点检配置",visible:e.add_dialogVisible,width:"1000px","close-on-click-modal":!1},on:{"update:visible":function(t){e.add_dialogVisible=t},close:e.cancelAddDialog}},[i("el-form",{ref:"addForm",staticClass:"add_form",staticStyle:{width:"100%"},attrs:{"label-width":"80px",inline:!0,model:e.addForm,rules:e.rules}},[i("el-row",{staticStyle:{"margin-bottom":"0px"}},[i("el-col",{attrs:{span:8}},[i("el-form-item",{staticClass:"el-inputcss",attrs:{label:"点检名称：",prop:"configName",rules:e.rules.configName}},[i("el-input",{ref:"focusinput",attrs:{size:"small",maxlength:"16",placeholder:"点检名称"},model:{value:e.addForm.configName,callback:function(t){e.$set(e.addForm,"configName",t)},expression:"addForm.configName"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{staticClass:"el-inputcss",attrs:{label:"使用级别：",prop:"workingLevel"}},[i("el-select",{attrs:{size:"small",placeholder:"使用级别"},model:{value:e.addForm.workingLevel,callback:function(t){e.$set(e.addForm,"workingLevel",t)},expression:"addForm.workingLevel"}},e._l(e.levelOption,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{staticClass:"el-inputcss",attrs:{label:"设备类型：",prop:"deviceTypeId"}},[i("el-select",{attrs:{size:"small",placeholder:"设备类型"},model:{value:e.addForm.deviceTypeId,callback:function(t){e.$set(e.addForm,"deviceTypeId",t)},expression:"addForm.deviceTypeId"}},e._l(e.deviceType,function(e){return i("el-option",{key:e.id,attrs:{label:e.typeName,value:e.id}})}),1)],1)],1)],1),e._v(" "),i("el-row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addDetailList()}}},[e._v("新增点检配置项")])],1)],1),e._v(" "),i("br"),e._v(" "),i("el-table",{staticClass:"check-list",staticStyle:{width:"100%","margin-bottom":"10px","overflow-y":"auto","max-height":"400px"},attrs:{data:e.addForm.inspectionConfigDetailList}},[i("el-table-column",{attrs:{label:"序号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",[i("span",[e._v(e._s(t.$index+1))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"点检内容",prop:"content",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",{attrs:{prop:"inspectionConfigDetailList["+t.$index+"].content",rules:e.rules.content}},[i("el-input",{ref:"focusprocedure"+t.$index,attrs:{size:"small",maxlength:"50"},model:{value:e.addForm.inspectionConfigDetailList[t.$index].content,callback:function(i){e.$set(e.addForm.inspectionConfigDetailList[t.$index],"content",i)},expression:"addForm.inspectionConfigDetailList[scope.$index].content"}})],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"检查方式",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",[i("el-select",{staticClass:"input-min-width",staticStyle:{display:"block"},attrs:{size:"small",placeholder:"检查方式"},model:{value:e.addForm.inspectionConfigDetailList[t.$index].inspectWay,callback:function(i){e.$set(e.addForm.inspectionConfigDetailList[t.$index],"inspectWay",i)},expression:"addForm.inspectionConfigDetailList[scope.$index].inspectWay"}},e._l(e.actType,function(e){return i("el-option",{key:e,attrs:{checked:!0,label:e,value:e}})}),1)],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"检查标准"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",{attrs:{prop:"inspectionConfigDetailList["+t.$index+"].criterion",rules:e.rules.criterion}},[i("el-input",{staticClass:"input_long",attrs:{autosize:"",type:"textarea",size:"small",maxlength:"50"},model:{value:e.addForm.inspectionConfigDetailList[t.$index].criterion,callback:function(i){e.$set(e.addForm.inspectionConfigDetailList[t.$index],"criterion",i)},expression:"addForm.inspectionConfigDetailList[scope.$index].criterion"}})],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",[i("div",{staticClass:"delete",attrs:{type:"primary"},on:{click:function(i){return e.removeDetail(t.$index)}}})])]}}])})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitAddDialog}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"编辑点检配置",width:"1000px",visible:e.editDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.editDialogVisible=t},close:e.cancelEditDialog}},[i("el-form",{ref:"editForm",staticClass:"add_form",staticStyle:{width:"100%"},attrs:{model:e.addForm,inline:!0,rules:e.rules}},[i("el-row",{staticStyle:{"margin-bottom":"0px"}},[i("el-col",{attrs:{span:8}},[i("el-form-item",{staticClass:"el-inputcss",attrs:{label:"点检名称：",prop:"configName",rules:e.rules.configName}},[i("el-input",{staticStyle:{"max-width":"180px"},attrs:{size:"small",maxlength:"50",placeholder:"点检名称"},model:{value:e.addForm.configName,callback:function(t){e.$set(e.addForm,"configName",t)},expression:"addForm.configName"}})],1)],1),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{staticClass:"el-inputcss",attrs:{label:"使用级别：",prop:"workingLevel"}},[i("el-select",{attrs:{size:"small",placeholder:"使用级别"},model:{value:e.addForm.workingLevel,callback:function(t){e.$set(e.addForm,"workingLevel",t)},expression:"addForm.workingLevel"}},e._l(e.levelOption,function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),i("el-col",{attrs:{span:8}},[i("el-form-item",{staticClass:"el-inputcss",attrs:{label:"设备类型："}},[i("el-select",{attrs:{size:"small",placeholder:"设备类型",filterable:""},model:{value:e.addForm.deviceTypeId,callback:function(t){e.$set(e.addForm,"deviceTypeId",t)},expression:"addForm.deviceTypeId"}},e._l(e.deviceType,function(e){return i("el-option",{key:e.id,attrs:{label:e.typeName,value:e.id}})}),1)],1)],1)],1),e._v(" "),i("el-row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addDetailList()}}},[e._v("新增点检配置项")])],1)],1),e._v(" "),i("br"),e._v(" "),i("el-table",{staticClass:"check-list",staticStyle:{width:"100%","margin-bottom":"10px","overflow-y":"auto","max-height":"457px"},attrs:{data:e.addForm.inspectionConfigDetailList,height:"457"}},[i("el-table-column",{attrs:{label:"序号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",[i("span",[e._v(e._s(t.$index+1))])])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"点检内容",prop:"content",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",{attrs:{prop:"inspectionConfigDetailList["+t.$index+"].content",rules:e.rules.content}},[i("el-input",{ref:"focusprocedure"+t.$index,attrs:{size:"small",maxlength:"50"},model:{value:e.addForm.inspectionConfigDetailList[t.$index].content,callback:function(i){e.$set(e.addForm.inspectionConfigDetailList[t.$index],"content",i)},expression:"addForm.inspectionConfigDetailList[scope.$index].content"}})],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"检查方式",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",[i("el-select",{staticClass:"input-min-width",staticStyle:{display:"block"},attrs:{size:"small",placeholder:"检查方式"},model:{value:e.addForm.inspectionConfigDetailList[t.$index].inspectWay,callback:function(i){e.$set(e.addForm.inspectionConfigDetailList[t.$index],"inspectWay",i)},expression:"addForm.inspectionConfigDetailList[scope.$index].inspectWay"}},e._l(e.actType,function(e){return i("el-option",{key:e,attrs:{checked:!0,label:e,value:e}})}),1)],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"检查标准"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",{attrs:{prop:"inspectionConfigDetailList["+t.$index+"].criterion",rules:e.rules.criterion}},[i("el-input",{staticClass:"input_long",attrs:{autosize:{minRows:1,maxRows:3},type:"textarea",maxlength:"50",size:"small"},model:{value:e.addForm.inspectionConfigDetailList[t.$index].criterion,callback:function(i){e.$set(e.addForm.inspectionConfigDetailList[t.$index],"criterion",i)},expression:"addForm.inspectionConfigDetailList[scope.$index].criterion"}})],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form-item",[i("div",{staticClass:"delete",attrs:{type:"primary"},on:{click:function(i){return e.removeDetail(t.$index)}}})])]}}])})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:e.submitEditDialog}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:"查看点检配置",visible:e.viewDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.viewDialogVisible=t},close:e.cancelViewDialog}},[i("el-form",{ref:"addForm",staticClass:"add_form",staticStyle:{width:"100%"},attrs:{model:e.addForm,rules:e.rules}},[i("div",{staticClass:"detail_info"},[i("div",{staticClass:"info"},[i("div",{staticClass:"label"},[e._v("点检名称：")]),e._v(" "),i("div",{staticClass:"value"},[e._v(e._s(e.addForm.configName))])]),e._v(" "),i("div",{staticClass:"info"},[i("div",{staticClass:"label"},[e._v("使用级别：")]),e._v(" "),i("div",{staticClass:"value"},[e._v(e._s(e.addForm.workingLevel))])]),e._v(" "),i("div",{staticClass:"info"},[i("div",{staticClass:"label"},[e._v("设备类型：")]),e._v(" "),i("div",{staticClass:"value"},[e._v(e._s(e.addForm.typeName))])])]),e._v(" "),i("el-table",{staticClass:"check-list",staticStyle:{width:"100%","margin-bottom":"10px","overflow-y":"auto","max-height":"450px"},attrs:{data:e.addForm.inspectionConfigDetailList}},[i("el-table-column",{attrs:{label:"序号",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",[e._v(e._s(t.$index+1))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"点检内容",prop:"content",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:"检查方式",width:"100",prop:"inspectWay"}}),e._v(" "),i("el-table-column",{attrs:{label:"检查标准",prop:"criterion"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.criterion.split("\n"),function(t,a){return i("div",{key:a},[e._v(e._s(t))])})}}])})],1)],1)],1)],1)},staticRenderFns:[]};var p=i("C7Lr")(d,u,!1,function(e){i("Niiv")},"data-v-47985344",null);t.default=p.exports}});